function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

import { map } from '@glimmer/reference';
import { assert, dict, EMPTY_ARRAY } from '@glimmer/util';
import * as WireFormat from '@glimmer/wire-format';
import OpcodeBuilder from '../compiled/opcodes/builder';
import { Register } from '../opcodes';
import * as ClientSide from '../syntax/client-side';
import RawInlineBlock from './raw-block';
var Ops = WireFormat.Ops;
export var ATTRS_BLOCK = '&attrs';

var Compilers = function () {
    function Compilers() {
        var offset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

        _classCallCheck(this, Compilers);

        this.offset = offset;
        this.names = dict();
        this.funcs = [];
    }

    Compilers.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Compilers.prototype.compile = function compile(sexp, builder) {
        var name = sexp[this.offset];
        var index = this.names[name];
        var func = this.funcs[index];
        assert(!!func, 'expected an implementation for ' + (this.offset === 0 ? Ops[sexp[0]] : ClientSide.Ops[sexp[1]]));
        func(sexp, builder);
    };

    return Compilers;
}();

var STATEMENTS = new Compilers();
var CLIENT_SIDE = new Compilers(1);
STATEMENTS.add(Ops.Text, function (sexp, builder) {
    builder.text(sexp[1]);
});
STATEMENTS.add(Ops.Comment, function (sexp, builder) {
    builder.comment(sexp[1]);
});
STATEMENTS.add(Ops.CloseElement, function (_sexp, builder) {
    builder.closeElement();
});
STATEMENTS.add(Ops.FlushElement, function (_sexp, builder) {
    builder.flushElement();
});
STATEMENTS.add(Ops.Modifier, function (sexp, builder) {
    var env = builder.env,
        meta = builder.meta;
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3];

    if (env.hasModifier(name, meta.templateMeta)) {
        builder.compileArgs(params, hash, true);
        builder.modifier(env.lookupModifier(name, meta.templateMeta));
    } else {
        throw new Error('Compile Error ' + name + ' is not a modifier: Helpers may not be used in the element form.');
    }
});
STATEMENTS.add(Ops.StaticAttr, function (sexp, builder) {
    var name = sexp[1],
        value = sexp[2],
        namespace = sexp[3];

    builder.staticAttr(name, namespace, value);
});
STATEMENTS.add(Ops.DynamicAttr, function (sexp, builder) {
    dynamicAttr(sexp, false, builder);
});
STATEMENTS.add(Ops.TrustingAttr, function (sexp, builder) {
    dynamicAttr(sexp, true, builder);
});
function dynamicAttr(sexp, trusting, builder) {
    var name = sexp[1],
        value = sexp[2],
        namespace = sexp[3];

    expr(value, builder);
    if (namespace) {
        builder.dynamicAttrNS(name, namespace, trusting);
    } else {
        builder.dynamicAttr(name, trusting);
    }
}
STATEMENTS.add(Ops.OpenElement, function (sexp, builder) {
    builder.openPrimitiveElement(sexp[1]);
});
CLIENT_SIDE.add(ClientSide.Ops.OpenComponentElement, function (sexp, builder) {
    builder.pushComponentOperations();
    builder.openElementWithOperations(sexp[2]);
});
CLIENT_SIDE.add(ClientSide.Ops.DidCreateElement, function (_sexp, builder) {
    builder.didCreateElement(Register.s0);
});
CLIENT_SIDE.add(ClientSide.Ops.DidRenderLayout, function (_sexp, builder) {
    builder.didRenderLayout(Register.s0);
});
STATEMENTS.add(Ops.Append, function (sexp, builder) {
    var value = sexp[1],
        trusting = sexp[2];

    var _builder$env$macros = builder.env.macros(),
        inlines = _builder$env$macros.inlines;

    var returned = inlines.compile(sexp, builder) || value;
    if (returned === true) return;
    var isGet = E.isGet(value);
    var isMaybeLocal = E.isMaybeLocal(value);
    if (trusting) {
        builder.guardedAppend(value, true);
    } else {
        if (isGet || isMaybeLocal) {
            builder.guardedAppend(value, false);
        } else {
            expr(value, builder);
            builder.cautiousAppend();
        }
    }
});
STATEMENTS.add(Ops.Block, function (sexp, builder) {
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3],
        _template = sexp[4],
        _inverse = sexp[5];

    var template = builder.template(_template);
    var inverse = builder.template(_inverse);
    var templateBlock = template && template.scan();
    var inverseBlock = inverse && inverse.scan();

    var _builder$env$macros2 = builder.env.macros(),
        blocks = _builder$env$macros2.blocks;

    blocks.compile(name, params, hash, templateBlock, inverseBlock, builder);
});
export var InvokeDynamicLayout = function () {
    function InvokeDynamicLayout(attrs) {
        _classCallCheck(this, InvokeDynamicLayout);

        this.attrs = attrs;
    }

    InvokeDynamicLayout.prototype.invoke = function invoke(vm, layout) {
        var _layout$symbolTable = layout.symbolTable,
            symbols = _layout$symbolTable.symbols,
            hasEval = _layout$symbolTable.hasEval;

        var stack = vm.stack;
        var scope = vm.pushRootScope(symbols.length + 1, true);
        scope.bindSelf(stack.pop());
        scope.bindBlock(symbols.indexOf(ATTRS_BLOCK) + 1, this.attrs);
        var lookup = null;
        var $eval = -1;
        if (hasEval) {
            $eval = symbols.indexOf('$eval') + 1;
            lookup = dict();
        }
        var callerNames = stack.pop();
        for (var i = callerNames.length - 1; i >= 0; i--) {
            var symbol = symbols.indexOf(callerNames[i]);
            var value = stack.pop();
            if (symbol !== -1) scope.bindSymbol(symbol + 1, value);
            if (hasEval) lookup[callerNames[i]] = value;
        }
        var numPositionalArgs = stack.pop();
        assert(typeof numPositionalArgs === 'number', '[BUG] Incorrect value of positional argument count found during invoke-dynamic-layout.');
        // Currently we don't support accessing positional args in templates, so just throw them away
        stack.pop(numPositionalArgs);
        var inverseSymbol = symbols.indexOf('&inverse');
        var inverse = stack.pop();
        if (inverseSymbol !== -1) {
            scope.bindBlock(inverseSymbol + 1, inverse);
        }
        if (lookup) lookup['&inverse'] = inverse;
        var defaultSymbol = symbols.indexOf('&default');
        var defaultBlock = stack.pop();
        if (defaultSymbol !== -1) {
            scope.bindBlock(defaultSymbol + 1, defaultBlock);
        }
        if (lookup) lookup['&default'] = defaultBlock;
        if (lookup) scope.bindEvalScope(lookup);
        vm.pushFrame();
        vm.call(layout.handle);
    };

    InvokeDynamicLayout.prototype.toJSON = function toJSON() {
        return { GlimmerDebug: '<invoke-dynamic-layout>' };
    };

    return InvokeDynamicLayout;
}();
STATEMENTS.add(Ops.Component, function (sexp, builder) {
    var tag = sexp[1],
        attrs = sexp[2],
        args = sexp[3],
        block = sexp[4];

    if (builder.env.hasComponentDefinition(tag, builder.meta.templateMeta)) {
        var child = builder.template(block);
        var attrsBlock = new RawInlineBlock(builder.meta, attrs, EMPTY_ARRAY);
        var definition = builder.env.getComponentDefinition(tag, builder.meta.templateMeta);
        builder.pushComponentManager(definition);
        builder.invokeComponent(attrsBlock, null, args, child && child.scan());
    } else if (block && block.parameters.length) {
        throw new Error('Compile Error: Cannot find component ' + tag);
    } else {
        builder.openPrimitiveElement(tag);
        for (var i = 0; i < attrs.length; i++) {
            STATEMENTS.compile(attrs[i], builder);
        }
        builder.flushElement();
        if (block) {
            var stmts = block.statements;
            for (var _i = 0; _i < stmts.length; _i++) {
                STATEMENTS.compile(stmts[_i], builder);
            }
        }
        builder.closeElement();
    }
});
export var PartialInvoker = function () {
    function PartialInvoker(outerSymbols, evalInfo) {
        _classCallCheck(this, PartialInvoker);

        this.outerSymbols = outerSymbols;
        this.evalInfo = evalInfo;
    }

    PartialInvoker.prototype.invoke = function invoke(vm, _partial) {
        var partial = _partial;
        var partialSymbols = partial.symbolTable.symbols;
        var outerScope = vm.scope();
        var partialScope = vm.pushRootScope(partialSymbols.length, false);
        partialScope.bindCallerScope(outerScope.getCallerScope());
        partialScope.bindEvalScope(outerScope.getEvalScope());
        partialScope.bindSelf(outerScope.getSelf());
        var evalInfo = this.evalInfo,
            outerSymbols = this.outerSymbols;

        var locals = dict();
        for (var i = 0; i < evalInfo.length; i++) {
            var slot = evalInfo[i];
            var name = outerSymbols[slot - 1];
            var ref = outerScope.getSymbol(slot);
            locals[name] = ref;
        }
        var evalScope = outerScope.getEvalScope();
        for (var _i2 = 0; _i2 < partialSymbols.length; _i2++) {
            var _name = partialSymbols[_i2];
            var symbol = _i2 + 1;
            var value = evalScope[_name];
            if (value !== undefined) partialScope.bind(symbol, value);
        }
        partialScope.bindPartialMap(locals);
        vm.pushFrame();
        vm.call(partial.handle);
    };

    return PartialInvoker;
}();
STATEMENTS.add(Ops.Partial, function (sexp, builder) {
    var name = sexp[1],
        evalInfo = sexp[2];
    var _builder$meta = builder.meta,
        templateMeta = _builder$meta.templateMeta,
        symbols = _builder$meta.symbols;

    function helper(vm, args) {
        var env = vm.env;

        var nameRef = args.positional.at(0);
        return map(nameRef, function (n) {
            if (typeof n === 'string' && n) {
                if (!env.hasPartial(n, templateMeta)) {
                    throw new Error('Could not find a partial named "' + n + '"');
                }
                return env.lookupPartial(n, templateMeta);
            } else if (n) {
                throw new Error('Could not find a partial named "' + String(n) + '"');
            } else {
                return null;
            }
        });
    }
    builder.startLabels();
    builder.pushFrame();
    builder.returnTo('END');
    expr(name, builder);
    builder.pushImmediate(1);
    builder.pushImmediate(EMPTY_ARRAY);
    builder.pushArgs(true);
    builder.helper(helper);
    builder.dup();
    builder.test('simple');
    builder.enter(2);
    builder.jumpUnless('ELSE');
    builder.getPartialTemplate();
    builder.compileDynamicBlock();
    builder.invokeDynamic(new PartialInvoker(symbols, evalInfo));
    builder.popScope();
    builder.popFrame();
    builder.label('ELSE');
    builder.exit();
    builder.return();
    builder.label('END');
    builder.popFrame();
    builder.stopLabels();
});

var InvokeDynamicYield = function () {
    function InvokeDynamicYield(callerCount) {
        _classCallCheck(this, InvokeDynamicYield);

        this.callerCount = callerCount;
    }

    InvokeDynamicYield.prototype.invoke = function invoke(vm, block) {
        var callerCount = this.callerCount;

        var stack = vm.stack;
        if (!block) {
            // To balance the pop{Frame,Scope}
            vm.pushFrame();
            vm.pushCallerScope();
            return;
        }
        var table = block.symbolTable;
        var locals = table.parameters; // always present in inline blocks
        var calleeCount = locals ? locals.length : 0;
        var count = Math.min(callerCount, calleeCount);
        vm.pushFrame();
        vm.pushCallerScope(calleeCount > 0);
        var scope = vm.scope();
        for (var i = 0; i < count; i++) {
            scope.bindSymbol(locals[i], stack.fromBase(callerCount - i));
        }
        vm.call(block.handle);
    };

    InvokeDynamicYield.prototype.toJSON = function toJSON() {
        return { GlimmerDebug: '<invoke-dynamic-yield caller-count=' + this.callerCount + '>' };
    };

    return InvokeDynamicYield;
}();

STATEMENTS.add(Ops.Yield, function (sexp, builder) {
    var to = sexp[1],
        params = sexp[2];

    var count = compileList(params, builder);
    builder.getBlock(to);
    builder.compileDynamicBlock();
    builder.invokeDynamic(new InvokeDynamicYield(count));
    builder.popScope();
    builder.popFrame();
    if (count) {
        builder.pop(count);
    }
});
STATEMENTS.add(Ops.Debugger, function (sexp, builder) {
    var evalInfo = sexp[1];

    builder.debugger(builder.meta.symbols, evalInfo);
});
STATEMENTS.add(Ops.ClientSideStatement, function (sexp, builder) {
    CLIENT_SIDE.compile(sexp, builder);
});
var EXPRESSIONS = new Compilers();
var CLIENT_SIDE_EXPRS = new Compilers(1);
var E = WireFormat.Expressions;
export function expr(expression, builder) {
    if (Array.isArray(expression)) {
        EXPRESSIONS.compile(expression, builder);
    } else {
        builder.primitive(expression);
    }
}
EXPRESSIONS.add(Ops.Unknown, function (sexp, builder) {
    var name = sexp[1];
    if (builder.env.hasHelper(name, builder.meta.templateMeta)) {
        EXPRESSIONS.compile([Ops.Helper, name, EMPTY_ARRAY, null], builder);
    } else if (builder.meta.asPartial) {
        builder.resolveMaybeLocal(name);
    } else {
        builder.getVariable(0);
        builder.getProperty(name);
    }
});
EXPRESSIONS.add(Ops.Concat, function (sexp, builder) {
    var parts = sexp[1];
    for (var i = 0; i < parts.length; i++) {
        expr(parts[i], builder);
    }
    builder.concat(parts.length);
});
CLIENT_SIDE_EXPRS.add(ClientSide.Ops.FunctionExpression, function (sexp, builder) {
    builder.function(sexp[2]);
});
EXPRESSIONS.add(Ops.Helper, function (sexp, builder) {
    var env = builder.env,
        meta = builder.meta;
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3];

    if (env.hasHelper(name, meta.templateMeta)) {
        builder.compileArgs(params, hash, true);
        builder.helper(env.lookupHelper(name, meta.templateMeta));
    } else {
        throw new Error('Compile Error: ' + name + ' is not a helper');
    }
});
EXPRESSIONS.add(Ops.Get, function (sexp, builder) {
    var head = sexp[1],
        path = sexp[2];

    builder.getVariable(head);
    for (var i = 0; i < path.length; i++) {
        builder.getProperty(path[i]);
    }
});
EXPRESSIONS.add(Ops.MaybeLocal, function (sexp, builder) {
    var path = sexp[1];

    if (builder.meta.asPartial) {
        var head = path[0];
        path = path.slice(1);
        builder.resolveMaybeLocal(head);
    } else {
        builder.getVariable(0);
    }
    for (var i = 0; i < path.length; i++) {
        builder.getProperty(path[i]);
    }
});
EXPRESSIONS.add(Ops.Undefined, function (_sexp, builder) {
    return builder.primitive(undefined);
});
EXPRESSIONS.add(Ops.HasBlock, function (sexp, builder) {
    builder.hasBlock(sexp[1]);
});
EXPRESSIONS.add(Ops.HasBlockParams, function (sexp, builder) {
    builder.hasBlockParams(sexp[1]);
});
EXPRESSIONS.add(Ops.ClientSideExpression, function (sexp, builder) {
    CLIENT_SIDE_EXPRS.compile(sexp, builder);
});
export function compileList(params, builder) {
    if (!params) return 0;
    for (var i = 0; i < params.length; i++) {
        expr(params[i], builder);
    }
    return params.length;
}
export var Blocks = function () {
    function Blocks() {
        _classCallCheck(this, Blocks);

        this.names = dict();
        this.funcs = [];
    }

    Blocks.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Blocks.prototype.addMissing = function addMissing(func) {
        this.missing = func;
    };

    Blocks.prototype.compile = function compile(name, params, hash, template, inverse, builder) {
        var index = this.names[name];
        if (index === undefined) {
            assert(!!this.missing, name + ' not found, and no catch-all block handler was registered');
            var func = this.missing;
            var handled = func(name, params, hash, template, inverse, builder);
            assert(!!handled, name + ' not found, and the catch-all block handler didn\'t handle it');
        } else {
            var _func = this.funcs[index];
            _func(params, hash, template, inverse, builder);
        }
    };

    return Blocks;
}();
export var BLOCKS = new Blocks();
export var Inlines = function () {
    function Inlines() {
        _classCallCheck(this, Inlines);

        this.names = dict();
        this.funcs = [];
    }

    Inlines.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Inlines.prototype.addMissing = function addMissing(func) {
        this.missing = func;
    };

    Inlines.prototype.compile = function compile(sexp, builder) {
        var value = sexp[1];
        // TODO: Fix this so that expression macros can return
        // things like components, so that {{component foo}}
        // is the same as {{(component foo)}}
        if (!Array.isArray(value)) return ['expr', value];
        var name = void 0;
        var params = void 0;
        var hash = void 0;
        if (value[0] === Ops.Helper) {
            name = value[1];
            params = value[2];
            hash = value[3];
        } else if (value[0] === Ops.Unknown) {
            name = value[1];
            params = hash = null;
        } else {
            return ['expr', value];
        }
        var index = this.names[name];
        if (index === undefined && this.missing) {
            var func = this.missing;
            var returned = func(name, params, hash, builder);
            return returned === false ? ['expr', value] : returned;
        } else if (index !== undefined) {
            var _func2 = this.funcs[index];
            var _returned = _func2(name, params, hash, builder);
            return _returned === false ? ['expr', value] : _returned;
        } else {
            return ['expr', value];
        }
    };

    return Inlines;
}();
export var INLINES = new Inlines();
populateBuiltins(BLOCKS, INLINES);
export function populateBuiltins() {
    var blocks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Blocks();
    var inlines = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Inlines();

    blocks.add('if', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #if requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.test('environment');
        builder.enter(1);
        builder.jumpUnless('ELSE');
        builder.invokeStatic(template);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('unless', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #unless requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.test('environment');
        builder.enter(1);
        builder.jumpIf('ELSE');
        builder.invokeStatic(template);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('with', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #with requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.dup();
        builder.test('environment');
        builder.enter(2);
        builder.jumpUnless('ELSE');
        builder.invokeStatic(template, 1);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('each', function (params, hash, template, inverse, builder) {
        //         Enter(BEGIN, END)
        // BEGIN:  Noop
        //         PutArgs
        //         PutIterable
        //         JumpUnless(ELSE)
        //         EnterList(BEGIN2, END2)
        // ITER:   Noop
        //         NextIter(BREAK)
        // BEGIN2: Noop
        //         PushChildScope
        //         Evaluate(default)
        //         PopScope
        // END2:   Noop
        //         Exit
        //         Jump(ITER)
        // BREAK:  Noop
        //         ExitList
        //         Jump(END)
        // ELSE:   Noop
        //         Evalulate(inverse)
        // END:    Noop
        //         Exit
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        if (hash && hash[0][0] === 'key') {
            expr(hash[1][0], builder);
        } else {
            builder.primitive(null);
        }
        expr(params[0], builder);
        builder.enter(2);
        builder.putIterator();
        builder.jumpUnless('ELSE');
        builder.pushFrame();
        builder.returnTo('ITER');
        builder.dup(Register.fp, 1);
        builder.enterList('BODY');
        builder.label('ITER');
        builder.iterate('BREAK');
        builder.label('BODY');
        builder.invokeStatic(template, 2);
        builder.pop(2);
        builder.exit();
        builder.return();
        builder.label('BREAK');
        builder.exitList();
        builder.popFrame();
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('-in-element', function (params, hash, template, _inverse, builder) {
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #-in-element requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        if (hash && hash[0].length) {
            var keys = hash[0],
                values = hash[1];

            if (keys.length === 1 && keys[0] === 'nextSibling') {
                expr(values[0], builder);
            } else {
                throw new Error('SYNTAX ERROR: #-in-element does not take a `' + keys[0] + '` option');
            }
        } else {
            expr(null, builder);
        }
        expr(params[0], builder);
        builder.dup();
        builder.test('simple');
        builder.enter(3);
        builder.jumpUnless('ELSE');
        builder.pushRemoteElement();
        builder.invokeStatic(template);
        builder.popRemoteElement();
        builder.label('ELSE');
        builder.exit();
        builder.return();
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('-with-dynamic-vars', function (_params, hash, template, _inverse, builder) {
        if (hash) {
            var names = hash[0],
                expressions = hash[1];

            compileList(expressions, builder);
            builder.pushDynamicScope();
            builder.bindDynamicScope(names);
            builder.invokeStatic(template);
            builder.popDynamicScope();
        } else {
            builder.invokeStatic(template);
        }
    });
    return { blocks: blocks, inlines: inlines };
}
export function compileStatement(statement, builder) {
    STATEMENTS.compile(statement, builder);
}
export function compileStatements(statements, meta, env) {
    var b = new OpcodeBuilder(env, meta);
    for (var i = 0; i < statements.length; i++) {
        compileStatement(statements[i], b);
    }
    return b;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zeW50YXgvZnVuY3Rpb25zLmpzIl0sIm5hbWVzIjpbIm1hcCIsImFzc2VydCIsImRpY3QiLCJFTVBUWV9BUlJBWSIsIldpcmVGb3JtYXQiLCJPcGNvZGVCdWlsZGVyIiwiUmVnaXN0ZXIiLCJDbGllbnRTaWRlIiwiUmF3SW5saW5lQmxvY2siLCJPcHMiLCJBVFRSU19CTE9DSyIsIkNvbXBpbGVycyIsIm9mZnNldCIsIm5hbWVzIiwiZnVuY3MiLCJhZGQiLCJuYW1lIiwiZnVuYyIsInB1c2giLCJsZW5ndGgiLCJjb21waWxlIiwic2V4cCIsImJ1aWxkZXIiLCJpbmRleCIsIlNUQVRFTUVOVFMiLCJDTElFTlRfU0lERSIsIlRleHQiLCJ0ZXh0IiwiQ29tbWVudCIsImNvbW1lbnQiLCJDbG9zZUVsZW1lbnQiLCJfc2V4cCIsImNsb3NlRWxlbWVudCIsIkZsdXNoRWxlbWVudCIsImZsdXNoRWxlbWVudCIsIk1vZGlmaWVyIiwiZW52IiwibWV0YSIsInBhcmFtcyIsImhhc2giLCJoYXNNb2RpZmllciIsInRlbXBsYXRlTWV0YSIsImNvbXBpbGVBcmdzIiwibW9kaWZpZXIiLCJsb29rdXBNb2RpZmllciIsIkVycm9yIiwiU3RhdGljQXR0ciIsInZhbHVlIiwibmFtZXNwYWNlIiwic3RhdGljQXR0ciIsIkR5bmFtaWNBdHRyIiwiZHluYW1pY0F0dHIiLCJUcnVzdGluZ0F0dHIiLCJ0cnVzdGluZyIsImV4cHIiLCJkeW5hbWljQXR0ck5TIiwiT3BlbkVsZW1lbnQiLCJvcGVuUHJpbWl0aXZlRWxlbWVudCIsIk9wZW5Db21wb25lbnRFbGVtZW50IiwicHVzaENvbXBvbmVudE9wZXJhdGlvbnMiLCJvcGVuRWxlbWVudFdpdGhPcGVyYXRpb25zIiwiRGlkQ3JlYXRlRWxlbWVudCIsImRpZENyZWF0ZUVsZW1lbnQiLCJzMCIsIkRpZFJlbmRlckxheW91dCIsImRpZFJlbmRlckxheW91dCIsIkFwcGVuZCIsIm1hY3JvcyIsImlubGluZXMiLCJyZXR1cm5lZCIsImlzR2V0IiwiRSIsImlzTWF5YmVMb2NhbCIsImd1YXJkZWRBcHBlbmQiLCJjYXV0aW91c0FwcGVuZCIsIkJsb2NrIiwiX3RlbXBsYXRlIiwiX2ludmVyc2UiLCJ0ZW1wbGF0ZSIsImludmVyc2UiLCJ0ZW1wbGF0ZUJsb2NrIiwic2NhbiIsImludmVyc2VCbG9jayIsImJsb2NrcyIsIkludm9rZUR5bmFtaWNMYXlvdXQiLCJhdHRycyIsImludm9rZSIsInZtIiwibGF5b3V0Iiwic3ltYm9sVGFibGUiLCJzeW1ib2xzIiwiaGFzRXZhbCIsInN0YWNrIiwic2NvcGUiLCJwdXNoUm9vdFNjb3BlIiwiYmluZFNlbGYiLCJwb3AiLCJiaW5kQmxvY2siLCJpbmRleE9mIiwibG9va3VwIiwiJGV2YWwiLCJjYWxsZXJOYW1lcyIsImkiLCJzeW1ib2wiLCJiaW5kU3ltYm9sIiwibnVtUG9zaXRpb25hbEFyZ3MiLCJpbnZlcnNlU3ltYm9sIiwiZGVmYXVsdFN5bWJvbCIsImRlZmF1bHRCbG9jayIsImJpbmRFdmFsU2NvcGUiLCJwdXNoRnJhbWUiLCJjYWxsIiwiaGFuZGxlIiwidG9KU09OIiwiR2xpbW1lckRlYnVnIiwiQ29tcG9uZW50IiwidGFnIiwiYXJncyIsImJsb2NrIiwiaGFzQ29tcG9uZW50RGVmaW5pdGlvbiIsImNoaWxkIiwiYXR0cnNCbG9jayIsImRlZmluaXRpb24iLCJnZXRDb21wb25lbnREZWZpbml0aW9uIiwicHVzaENvbXBvbmVudE1hbmFnZXIiLCJpbnZva2VDb21wb25lbnQiLCJwYXJhbWV0ZXJzIiwic3RtdHMiLCJzdGF0ZW1lbnRzIiwiUGFydGlhbEludm9rZXIiLCJvdXRlclN5bWJvbHMiLCJldmFsSW5mbyIsIl9wYXJ0aWFsIiwicGFydGlhbCIsInBhcnRpYWxTeW1ib2xzIiwib3V0ZXJTY29wZSIsInBhcnRpYWxTY29wZSIsImJpbmRDYWxsZXJTY29wZSIsImdldENhbGxlclNjb3BlIiwiZ2V0RXZhbFNjb3BlIiwiZ2V0U2VsZiIsImxvY2FscyIsInNsb3QiLCJyZWYiLCJnZXRTeW1ib2wiLCJldmFsU2NvcGUiLCJ1bmRlZmluZWQiLCJiaW5kIiwiYmluZFBhcnRpYWxNYXAiLCJQYXJ0aWFsIiwiaGVscGVyIiwibmFtZVJlZiIsInBvc2l0aW9uYWwiLCJhdCIsIm4iLCJoYXNQYXJ0aWFsIiwibG9va3VwUGFydGlhbCIsIlN0cmluZyIsInN0YXJ0TGFiZWxzIiwicmV0dXJuVG8iLCJwdXNoSW1tZWRpYXRlIiwicHVzaEFyZ3MiLCJkdXAiLCJ0ZXN0IiwiZW50ZXIiLCJqdW1wVW5sZXNzIiwiZ2V0UGFydGlhbFRlbXBsYXRlIiwiY29tcGlsZUR5bmFtaWNCbG9jayIsImludm9rZUR5bmFtaWMiLCJwb3BTY29wZSIsInBvcEZyYW1lIiwibGFiZWwiLCJleGl0IiwicmV0dXJuIiwic3RvcExhYmVscyIsIkludm9rZUR5bmFtaWNZaWVsZCIsImNhbGxlckNvdW50IiwicHVzaENhbGxlclNjb3BlIiwidGFibGUiLCJjYWxsZWVDb3VudCIsImNvdW50IiwiTWF0aCIsIm1pbiIsImZyb21CYXNlIiwiWWllbGQiLCJ0byIsImNvbXBpbGVMaXN0IiwiZ2V0QmxvY2siLCJEZWJ1Z2dlciIsImRlYnVnZ2VyIiwiQ2xpZW50U2lkZVN0YXRlbWVudCIsIkVYUFJFU1NJT05TIiwiQ0xJRU5UX1NJREVfRVhQUlMiLCJFeHByZXNzaW9ucyIsImV4cHJlc3Npb24iLCJBcnJheSIsImlzQXJyYXkiLCJwcmltaXRpdmUiLCJVbmtub3duIiwiaGFzSGVscGVyIiwiSGVscGVyIiwiYXNQYXJ0aWFsIiwicmVzb2x2ZU1heWJlTG9jYWwiLCJnZXRWYXJpYWJsZSIsImdldFByb3BlcnR5IiwiQ29uY2F0IiwicGFydHMiLCJjb25jYXQiLCJGdW5jdGlvbkV4cHJlc3Npb24iLCJmdW5jdGlvbiIsImxvb2t1cEhlbHBlciIsIkdldCIsImhlYWQiLCJwYXRoIiwiTWF5YmVMb2NhbCIsInNsaWNlIiwiVW5kZWZpbmVkIiwiSGFzQmxvY2siLCJoYXNCbG9jayIsIkhhc0Jsb2NrUGFyYW1zIiwiaGFzQmxvY2tQYXJhbXMiLCJDbGllbnRTaWRlRXhwcmVzc2lvbiIsIkJsb2NrcyIsImFkZE1pc3NpbmciLCJtaXNzaW5nIiwiaGFuZGxlZCIsIkJMT0NLUyIsIklubGluZXMiLCJJTkxJTkVTIiwicG9wdWxhdGVCdWlsdGlucyIsIl9oYXNoIiwiaW52b2tlU3RhdGljIiwianVtcCIsImp1bXBJZiIsInB1dEl0ZXJhdG9yIiwiZnAiLCJlbnRlckxpc3QiLCJpdGVyYXRlIiwiZXhpdExpc3QiLCJrZXlzIiwidmFsdWVzIiwicHVzaFJlbW90ZUVsZW1lbnQiLCJwb3BSZW1vdGVFbGVtZW50IiwiX3BhcmFtcyIsImV4cHJlc3Npb25zIiwicHVzaER5bmFtaWNTY29wZSIsImJpbmREeW5hbWljU2NvcGUiLCJwb3BEeW5hbWljU2NvcGUiLCJjb21waWxlU3RhdGVtZW50Iiwic3RhdGVtZW50IiwiY29tcGlsZVN0YXRlbWVudHMiLCJiIl0sIm1hcHBpbmdzIjoiOztBQUFBLFNBQVNBLEdBQVQsUUFBb0Isb0JBQXBCO0FBQ0EsU0FBU0MsTUFBVCxFQUFpQkMsSUFBakIsRUFBdUJDLFdBQXZCLFFBQWtELGVBQWxEO0FBQ0EsT0FBTyxLQUFLQyxVQUFaLE1BQTRCLHNCQUE1QjtBQUNBLE9BQU9DLGFBQVAsTUFBMEIsNkJBQTFCO0FBQ0EsU0FBU0MsUUFBVCxRQUF5QixZQUF6QjtBQUNBLE9BQU8sS0FBS0MsVUFBWixNQUE0Qix1QkFBNUI7QUFDQSxPQUFPQyxjQUFQLE1BQTJCLGFBQTNCO0FBQ0EsSUFBSUMsTUFBTUwsV0FBV0ssR0FBckI7QUFDQSxPQUFPLElBQU1DLGNBQWMsUUFBcEI7O0lBQ0RDLFM7QUFDRix5QkFBd0I7QUFBQSxZQUFaQyxNQUFZLHVFQUFILENBQUc7O0FBQUE7O0FBQ3BCLGFBQUtBLE1BQUwsR0FBY0EsTUFBZDtBQUNBLGFBQUtDLEtBQUwsR0FBYVgsTUFBYjtBQUNBLGFBQUtZLEtBQUwsR0FBYSxFQUFiO0FBQ0g7O3dCQUNEQyxHLGdCQUFJQyxJLEVBQU1DLEksRUFBTTtBQUNaLGFBQUtILEtBQUwsQ0FBV0ksSUFBWCxDQUFn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dFAsYUFBSixDQUFrQitCLEdBQWxCLEVBQXVCQyxJQUF2QixDQUFSO0FBQ0EsU0FBSyxJQUFJaUUsSUFBSSxDQUFiLEVBQWdCQSxJQUFJMEIsV0FBVzdHLE1BQS9CLEVBQXVDbUYsR0FBdkMsRUFBNEM7QUFDeENrSix5QkFBaUJ4SCxXQUFXMUIsQ0FBWCxDQUFqQixFQUFnQ3FKLENBQWhDO0FBQ0g7QUFDRCxXQUFPQSxDQUFQO0FBQ0giLCJmaWxlIjoibGliL3N5bnRheC9mdW5jdGlvbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtYXAgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgYXNzZXJ0LCBkaWN0LCBFTVBUWV9BUlJBWSwgdW53cmFwIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgKiBhcyBXaXJlRm9ybWF0IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcbmltcG9ydCBPcGNvZGVCdWlsZGVyIGZyb20gJy4uL2NvbXBpbGVkL29wY29kZXMvYnVpbGRlcic7XG5pbXBvcnQgeyBSZWdpc3RlciB9IGZyb20gJy4uL29wY29kZXMnO1xuaW1wb3J0ICogYXMgQ2xpZW50U2lkZSBmcm9tICcuLi9zeW50YXgvY2xpZW50LXNpZGUnO1xuaW1wb3J0IFJhd0lubGluZUJsb2NrIGZyb20gJy4vcmF3LWJsb2NrJztcbnZhciBPcHMgPSBXaXJlRm9ybWF0Lk9wcztcbmV4cG9ydCBjb25zdCBBVFRSU19CTE9DSyA9ICcmYXR0cnMnO1xuY2xhc3MgQ29tcGlsZXJzIHtcbiAgICBjb25zdHJ1Y3RvcihvZmZzZXQgPSAwKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICB0aGlzLm5hbWVzID0gZGljdCgpO1xuICAgICAgICB0aGlzLmZ1bmNzID0gW107XG4gICAgfVxuICAgIGFkZChuYW1lLCBmdW5jKSB7XG4gICAgICAgIHRoaXMuZnVuY3MucHVzaChmdW5jKTtcbiAgICAgICAgdGhpcy5uYW1lc1tuYW1lXSA9IHRoaXMuZnVuY3MubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgY29tcGlsZShzZXhwLCBidWlsZGVyKSB7XG4gICAgICAgIGxldCBuYW1lID0gc2V4cFt0aGlzLm9mZnNldF07XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMubmFtZXNbbmFtZV07XG4gICAgICAgIGxldCBmdW5jID0gdGhpcy5mdW5jc1tpbmRleF07XG4gICAgICAgIGFzc2VydCghIWZ1bmMsIGBleHBlY3RlZCBhbiBpbXBsZW1lbnRhdGlvbiBmb3IgJHt0aGlzLm9mZnNldCA9PT0gMCA/IE9wc1tzZXhwWzBdXSA6IENsaWVudFNpZGUuT3BzW3NleHBbMV1dfWApO1xuICAgICAgICBmdW5jKHNleHAsIGJ1aWxkZXIpO1xuICAgIH1cbn1cbmNvbnN0IFNUQVRFTUVOVFMgPSBuZXcgQ29tcGlsZXJzKCk7XG5jb25zdCBDTElFTlRfU0lERSA9IG5ldyBDb21waWxlcnMoMSk7XG5TVEFURU1FTlRTLmFkZChPcHMuVGV4dCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLnRleHQoc2V4cFsxXSk7XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5Db21tZW50LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuY29tbWVudChzZXhwWzFdKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkNsb3NlRWxlbWVudCwgKF9zZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5jbG9zZUVsZW1lbnQoKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkZsdXNoRWxlbWVudCwgKF9zZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5mbHVzaEVsZW1lbnQoKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLk1vZGlmaWVyLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCB7IGVudiwgbWV0YSB9ID0gYnVpbGRlcjtcbiAgICBsZXQgWywgbmFtZSwgcGFyYW1zLCBoYXNoXSA9IHNleHA7XG4gICAgaWYgKGVudi5oYXNNb2RpZmllcihuYW1lLCBtZXRhLnRlbXBsYXRlTWV0YSkpIHtcbiAgICAgICAgYnVpbGRlci5jb21waWxlQXJncyhwYXJhbXMsIGhhc2gsIHRydWUpO1xuICAgICAgICBidWlsZGVyLm1vZGlmaWVyKGVudi5sb29rdXBNb2RpZmllcihuYW1lLCBtZXRhLnRlbXBsYXRlTWV0YSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcGlsZSBFcnJvciAke25hbWV9IGlzIG5vdCBhIG1vZGlmaWVyOiBIZWxwZXJzIG1heSBub3QgYmUgdXNlZCBpbiB0aGUgZWxlbWVudCBmb3JtLmApO1xuICAgIH1cbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLlN0YXRpY0F0dHIsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdID0gc2V4cDtcbiAgICBidWlsZGVyLnN0YXRpY0F0dHIobmFtZSwgbmFtZXNwYWNlLCB2YWx1ZSk7XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5EeW5hbWljQXR0ciwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBkeW5hbWljQXR0cihzZXhwLCBmYWxzZSwgYnVpbGRlcik7XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5UcnVzdGluZ0F0dHIsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgZHluYW1pY0F0dHIoc2V4cCwgdHJ1ZSwgYnVpbGRlcik7XG59KTtcbmZ1bmN0aW9uIGR5bmFtaWNBdHRyKHNleHAsIHRydXN0aW5nLCBidWlsZGVyKSB7XG4gICAgbGV0IFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdID0gc2V4cDtcbiAgICBleHByKHZhbHVlLCBidWlsZGVyKTtcbiAgICBpZiAobmFtZXNwYWNlKSB7XG4gICAgICAgIGJ1aWxkZXIuZHluYW1pY0F0dHJOUyhuYW1lLCBuYW1lc3BhY2UsIHRydXN0aW5nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBidWlsZGVyLmR5bmFtaWNBdHRyKG5hbWUsIHRydXN0aW5nKTtcbiAgICB9XG59XG5TVEFURU1FTlRTLmFkZChPcHMuT3BlbkVsZW1lbnQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5vcGVuUHJpbWl0aXZlRWxlbWVudChzZXhwWzFdKTtcbn0pO1xuQ0xJRU5UX1NJREUuYWRkKENsaWVudFNpZGUuT3BzLk9wZW5Db21wb25lbnRFbGVtZW50LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIucHVzaENvbXBvbmVudE9wZXJhdGlvbnMoKTtcbiAgICBidWlsZGVyLm9wZW5FbGVtZW50V2l0aE9wZXJhdGlvbnMoc2V4cFsyXSk7XG59KTtcbkNMSUVOVF9TSURFLmFkZChDbGllbnRTaWRlLk9wcy5EaWRDcmVhdGVFbGVtZW50LCAoX3NleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmRpZENyZWF0ZUVsZW1lbnQoUmVnaXN0ZXIuczApO1xufSk7XG5DTElFTlRfU0lERS5hZGQoQ2xpZW50U2lkZS5PcHMuRGlkUmVuZGVyTGF5b3V0LCAoX3NleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmRpZFJlbmRlckxheW91dChSZWdpc3Rlci5zMCk7XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5BcHBlbmQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHZhbHVlLCB0cnVzdGluZ10gPSBzZXhwO1xuICAgIGxldCB7IGlubGluZXMgfSA9IGJ1aWxkZXIuZW52Lm1hY3JvcygpO1xuICAgIGxldCByZXR1cm5lZCA9IGlubGluZXMuY29tcGlsZShzZXhwLCBidWlsZGVyKSB8fCB2YWx1ZTtcbiAgICBpZiAocmV0dXJuZWQgPT09IHRydWUpIHJldHVybjtcbiAgICBsZXQgaXNHZXQgPSBFLmlzR2V0KHZhbHVlKTtcbiAgICBsZXQgaXNNYXliZUxvY2FsID0gRS5pc01heWJlTG9jYWwodmFsdWUpO1xuICAgIGlmICh0cnVzdGluZykge1xuICAgICAgICBidWlsZGVyLmd1YXJkZWRBcHBlbmQodmFsdWUsIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpc0dldCB8fCBpc01heWJlTG9jYWwpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuZ3VhcmRlZEFwcGVuZCh2YWx1ZSwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwcih2YWx1ZSwgYnVpbGRlcik7XG4gICAgICAgICAgICBidWlsZGVyLmNhdXRpb3VzQXBwZW5kKCk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5CbG9jaywgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgbmFtZSwgcGFyYW1zLCBoYXNoLCBfdGVtcGxhdGUsIF9pbnZlcnNlXSA9IHNleHA7XG4gICAgbGV0IHRlbXBsYXRlID0gYnVpbGRlci50ZW1wbGF0ZShfdGVtcGxhdGUpO1xuICAgIGxldCBpbnZlcnNlID0gYnVpbGRlci50ZW1wbGF0ZShfaW52ZXJzZSk7XG4gICAgbGV0IHRlbXBsYXRlQmxvY2sgPSB0ZW1wbGF0ZSAmJiB0ZW1wbGF0ZS5zY2FuKCk7XG4gICAgbGV0IGludmVyc2VCbG9jayA9IGludmVyc2UgJiYgaW52ZXJzZS5zY2FuKCk7XG4gICAgbGV0IHsgYmxvY2tzIH0gPSBidWlsZGVyLmVudi5tYWNyb3MoKTtcbiAgICBibG9ja3MuY29tcGlsZShuYW1lLCBwYXJhbXMsIGhhc2gsIHRlbXBsYXRlQmxvY2ssIGludmVyc2VCbG9jaywgYnVpbGRlcik7XG59KTtcbmV4cG9ydCBjbGFzcyBJbnZva2VEeW5hbWljTGF5b3V0IHtcbiAgICBjb25zdHJ1Y3RvcihhdHRycykge1xuICAgICAgICB0aGlzLmF0dHJzID0gYXR0cnM7XG4gICAgfVxuICAgIGludm9rZSh2bSwgbGF5b3V0KSB7XG4gICAgICAgIGxldCB7IHN5bWJvbHMsIGhhc0V2YWwgfSA9IGxheW91dC5zeW1ib2xUYWJsZTtcbiAgICAgICAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gICAgICAgIGxldCBzY29wZSA9IHZtLnB1c2hSb290U2NvcGUoc3ltYm9scy5sZW5ndGggKyAxLCB0cnVlKTtcbiAgICAgICAgc2NvcGUuYmluZFNlbGYoc3RhY2sucG9wKCkpO1xuICAgICAgICBzY29wZS5iaW5kQmxvY2soc3ltYm9scy5pbmRleE9mKEFUVFJTX0JMT0NLKSArIDEsIHRoaXMuYXR0cnMpO1xuICAgICAgICBsZXQgbG9va3VwID0gbnVsbDtcbiAgICAgICAgbGV0ICRldmFsID0gLTE7XG4gICAgICAgIGlmIChoYXNFdmFsKSB7XG4gICAgICAgICAgICAkZXZhbCA9IHN5bWJvbHMuaW5kZXhPZignJGV2YWwnKSArIDE7XG4gICAgICAgICAgICBsb29rdXAgPSBkaWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNhbGxlck5hbWVzID0gc3RhY2sucG9wKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSBjYWxsZXJOYW1lcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgbGV0IHN5bWJvbCA9IHN5bWJvbHMuaW5kZXhPZihjYWxsZXJOYW1lc1tpXSk7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIGlmIChzeW1ib2wgIT09IC0xKSBzY29wZS5iaW5kU3ltYm9sKHN5bWJvbCArIDEsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChoYXNFdmFsKSBsb29rdXBbY2FsbGVyTmFtZXNbaV1dID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG51bVBvc2l0aW9uYWxBcmdzID0gc3RhY2sucG9wKCk7XG4gICAgICAgIGFzc2VydCh0eXBlb2YgbnVtUG9zaXRpb25hbEFyZ3MgPT09ICdudW1iZXInLCAnW0JVR10gSW5jb3JyZWN0IHZhbHVlIG9mIHBvc2l0aW9uYWwgYXJndW1lbnQgY291bnQgZm91bmQgZHVyaW5nIGludm9rZS1keW5hbWljLWxheW91dC4nKTtcbiAgICAgICAgLy8gQ3VycmVudGx5IHdlIGRvbid0IHN1cHBvcnQgYWNjZXNzaW5nIHBvc2l0aW9uYWwgYXJncyBpbiB0ZW1wbGF0ZXMsIHNvIGp1c3QgdGhyb3cgdGhlbSBhd2F5XG4gICAgICAgIHN0YWNrLnBvcChudW1Qb3NpdGlvbmFsQXJncyk7XG4gICAgICAgIGxldCBpbnZlcnNlU3ltYm9sID0gc3ltYm9scy5pbmRleE9mKCcmaW52ZXJzZScpO1xuICAgICAgICBsZXQgaW52ZXJzZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICBpZiAoaW52ZXJzZVN5bWJvbCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHNjb3BlLmJpbmRCbG9jayhpbnZlcnNlU3ltYm9sICsgMSwgaW52ZXJzZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvb2t1cCkgbG9va3VwWycmaW52ZXJzZSddID0gaW52ZXJzZTtcbiAgICAgICAgbGV0IGRlZmF1bHRTeW1ib2wgPSBzeW1ib2xzLmluZGV4T2YoJyZkZWZhdWx0Jyk7XG4gICAgICAgIGxldCBkZWZhdWx0QmxvY2sgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgaWYgKGRlZmF1bHRTeW1ib2wgIT09IC0xKSB7XG4gICAgICAgICAgICBzY29wZS5iaW5kQmxvY2soZGVmYXVsdFN5bWJvbCArIDEsIGRlZmF1bHRCbG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvb2t1cCkgbG9va3VwWycmZGVmYXVsdCddID0gZGVmYXVsdEJsb2NrO1xuICAgICAgICBpZiAobG9va3VwKSBzY29wZS5iaW5kRXZhbFNjb3BlKGxvb2t1cCk7XG4gICAgICAgIHZtLnB1c2hGcmFtZSgpO1xuICAgICAgICB2bS5jYWxsKGxheW91dC5oYW5kbGUpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7IEdsaW1tZXJEZWJ1ZzogJzxpbnZva2UtZHluYW1pYy1sYXlvdXQ+JyB9O1xuICAgIH1cbn1cblNUQVRFTUVOVFMuYWRkKE9wcy5Db21wb25lbnQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHRhZywgYXR0cnMsIGFyZ3MsIGJsb2NrXSA9IHNleHA7XG4gICAgaWYgKGJ1aWxkZXIuZW52Lmhhc0NvbXBvbmVudERlZmluaXRpb24odGFnLCBidWlsZGVyLm1ldGEudGVtcGxhdGVNZXRhKSkge1xuICAgICAgICBsZXQgY2hpbGQgPSBidWlsZGVyLnRlbXBsYXRlKGJsb2NrKTtcbiAgICAgICAgbGV0IGF0dHJzQmxvY2sgPSBuZXcgUmF3SW5saW5lQmxvY2soYnVpbGRlci5tZXRhLCBhdHRycywgRU1QVFlfQVJSQVkpO1xuICAgICAgICBsZXQgZGVmaW5pdGlvbiA9IGJ1aWxkZXIuZW52LmdldENvbXBvbmVudERlZmluaXRpb24odGFnLCBidWlsZGVyLm1ldGEudGVtcGxhdGVNZXRhKTtcbiAgICAgICAgYnVpbGRlci5wdXNoQ29tcG9uZW50TWFuYWdlcihkZWZpbml0aW9uKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VDb21wb25lbnQoYXR0cnNCbG9jaywgbnVsbCwgYXJncywgY2hpbGQgJiYgY2hpbGQuc2NhbigpKTtcbiAgICB9IGVsc2UgaWYgKGJsb2NrICYmIGJsb2NrLnBhcmFtZXRlcnMubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcGlsZSBFcnJvcjogQ2Fubm90IGZpbmQgY29tcG9uZW50ICR7dGFnfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1aWxkZXIub3BlblByaW1pdGl2ZUVsZW1lbnQodGFnKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgU1RBVEVNRU5UUy5jb21waWxlKGF0dHJzW2ldLCBidWlsZGVyKTtcbiAgICAgICAgfVxuICAgICAgICBidWlsZGVyLmZsdXNoRWxlbWVudCgpO1xuICAgICAgICBpZiAoYmxvY2spIHtcbiAgICAgICAgICAgIGxldCBzdG10cyA9IGJsb2NrLnN0YXRlbWVudHM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0bXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgU1RBVEVNRU5UUy5jb21waWxlKHN0bXRzW2ldLCBidWlsZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBidWlsZGVyLmNsb3NlRWxlbWVudCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0IGNsYXNzIFBhcnRpYWxJbnZva2VyIHtcbiAgICBjb25zdHJ1Y3RvcihvdXRlclN5bWJvbHMsIGV2YWxJbmZvKSB7XG4gICAgICAgIHRoaXMub3V0ZXJTeW1ib2xzID0gb3V0ZXJTeW1ib2xzO1xuICAgICAgICB0aGlzLmV2YWxJbmZvID0gZXZhbEluZm87XG4gICAgfVxuICAgIGludm9rZSh2bSwgX3BhcnRpYWwpIHtcbiAgICAgICAgbGV0IHBhcnRpYWwgPSB1bndyYXAoX3BhcnRpYWwpO1xuICAgICAgICBsZXQgcGFydGlhbFN5bWJvbHMgPSBwYXJ0aWFsLnN5bWJvbFRhYmxlLnN5bWJvbHM7XG4gICAgICAgIGxldCBvdXRlclNjb3BlID0gdm0uc2NvcGUoKTtcbiAgICAgICAgbGV0IHBhcnRpYWxTY29wZSA9IHZtLnB1c2hSb290U2NvcGUocGFydGlhbFN5bWJvbHMubGVuZ3RoLCBmYWxzZSk7XG4gICAgICAgIHBhcnRpYWxTY29wZS5iaW5kQ2FsbGVyU2NvcGUob3V0ZXJTY29wZS5nZXRDYWxsZXJTY29wZSgpKTtcbiAgICAgICAgcGFydGlhbFNjb3BlLmJpbmRFdmFsU2NvcGUob3V0ZXJTY29wZS5nZXRFdmFsU2NvcGUoKSk7XG4gICAgICAgIHBhcnRpYWxTY29wZS5iaW5kU2VsZihvdXRlclNjb3BlLmdldFNlbGYoKSk7XG4gICAgICAgIGxldCB7IGV2YWxJbmZvLCBvdXRlclN5bWJvbHMgfSA9IHRoaXM7XG4gICAgICAgIGxldCBsb2NhbHMgPSBkaWN0KCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZhbEluZm8ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBzbG90ID0gZXZhbEluZm9baV07XG4gICAgICAgICAgICBsZXQgbmFtZSA9IG91dGVyU3ltYm9sc1tzbG90IC0gMV07XG4gICAgICAgICAgICBsZXQgcmVmID0gb3V0ZXJTY29wZS5nZXRTeW1ib2woc2xvdCk7XG4gICAgICAgICAgICBsb2NhbHNbbmFtZV0gPSByZWY7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGV2YWxTY29wZSA9IG91dGVyU2NvcGUuZ2V0RXZhbFNjb3BlKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydGlhbFN5bWJvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBuYW1lID0gcGFydGlhbFN5bWJvbHNbaV07XG4gICAgICAgICAgICBsZXQgc3ltYm9sID0gaSArIDE7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBldmFsU2NvcGVbbmFtZV07XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgcGFydGlhbFNjb3BlLmJpbmQoc3ltYm9sLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcGFydGlhbFNjb3BlLmJpbmRQYXJ0aWFsTWFwKGxvY2Fscyk7XG4gICAgICAgIHZtLnB1c2hGcmFtZSgpO1xuICAgICAgICB2bS5jYWxsKHBhcnRpYWwuaGFuZGxlKTtcbiAgICB9XG59XG5TVEFURU1FTlRTLmFkZChPcHMuUGFydGlhbCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgbmFtZSwgZXZhbEluZm9dID0gc2V4cDtcbiAgICBsZXQgeyB0ZW1wbGF0ZU1ldGEsIHN5bWJvbHMgfSA9IGJ1aWxkZXIubWV0YTtcbiAgICBmdW5jdGlvbiBoZWxwZXIodm0sIGFyZ3MpIHtcbiAgICAgICAgbGV0IHsgZW52IH0gPSB2bTtcbiAgICAgICAgbGV0IG5hbWVSZWYgPSBhcmdzLnBvc2l0aW9uYWwuYXQoMCk7XG4gICAgICAgIHJldHVybiBtYXAobmFtZVJlZiwgbiA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIG4gPT09ICdzdHJpbmcnICYmIG4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVudi5oYXNQYXJ0aWFsKG4sIHRlbXBsYXRlTWV0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBhIHBhcnRpYWwgbmFtZWQgXCIke259XCJgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudi5sb29rdXBQYXJ0aWFsKG4sIHRlbXBsYXRlTWV0YSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIGEgcGFydGlhbCBuYW1lZCBcIiR7U3RyaW5nKG4pfVwiYCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG4gICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgZXhwcihuYW1lLCBidWlsZGVyKTtcbiAgICBidWlsZGVyLnB1c2hJbW1lZGlhdGUoMSk7XG4gICAgYnVpbGRlci5wdXNoSW1tZWRpYXRlKEVNUFRZX0FSUkFZKTtcbiAgICBidWlsZGVyLnB1c2hBcmdzKHRydWUpO1xuICAgIGJ1aWxkZXIuaGVscGVyKGhlbHBlcik7XG4gICAgYnVpbGRlci5kdXAoKTtcbiAgICBidWlsZGVyLnRlc3QoJ3NpbXBsZScpO1xuICAgIGJ1aWxkZXIuZW50ZXIoMik7XG4gICAgYnVpbGRlci5qdW1wVW5sZXNzKCdFTFNFJyk7XG4gICAgYnVpbGRlci5nZXRQYXJ0aWFsVGVtcGxhdGUoKTtcbiAgICBidWlsZGVyLmNvbXBpbGVEeW5hbWljQmxvY2soKTtcbiAgICBidWlsZGVyLmludm9rZUR5bmFtaWMobmV3IFBhcnRpYWxJbnZva2VyKHN5bWJvbHMsIGV2YWxJbmZvKSk7XG4gICAgYnVpbGRlci5wb3BTY29wZSgpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgYnVpbGRlci5leGl0KCk7XG4gICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICBidWlsZGVyLmxhYmVsKCdFTkQnKTtcbiAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG59KTtcbmNsYXNzIEludm9rZUR5bmFtaWNZaWVsZCB7XG4gICAgY29uc3RydWN0b3IoY2FsbGVyQ291bnQpIHtcbiAgICAgICAgdGhpcy5jYWxsZXJDb3VudCA9IGNhbGxlckNvdW50O1xuICAgIH1cbiAgICBpbnZva2Uodm0sIGJsb2NrKSB7XG4gICAgICAgIGxldCB7IGNhbGxlckNvdW50IH0gPSB0aGlzO1xuICAgICAgICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgICAgICAgaWYgKCFibG9jaykge1xuICAgICAgICAgICAgLy8gVG8gYmFsYW5jZSB0aGUgcG9we0ZyYW1lLFNjb3BlfVxuICAgICAgICAgICAgdm0ucHVzaEZyYW1lKCk7XG4gICAgICAgICAgICB2bS5wdXNoQ2FsbGVyU2NvcGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdGFibGUgPSBibG9jay5zeW1ib2xUYWJsZTtcbiAgICAgICAgbGV0IGxvY2FscyA9IHRhYmxlLnBhcmFtZXRlcnM7IC8vIGFsd2F5cyBwcmVzZW50IGluIGlubGluZSBibG9ja3NcbiAgICAgICAgbGV0IGNhbGxlZUNvdW50ID0gbG9jYWxzID8gbG9jYWxzLmxlbmd0aCA6IDA7XG4gICAgICAgIGxldCBjb3VudCA9IE1hdGgubWluKGNhbGxlckNvdW50LCBjYWxsZWVDb3VudCk7XG4gICAgICAgIHZtLnB1c2hGcmFtZSgpO1xuICAgICAgICB2bS5wdXNoQ2FsbGVyU2NvcGUoY2FsbGVlQ291bnQgPiAwKTtcbiAgICAgICAgbGV0IHNjb3BlID0gdm0uc2NvcGUoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICBzY29wZS5iaW5kU3ltYm9sKGxvY2Fsc1tpXSwgc3RhY2suZnJvbUJhc2UoY2FsbGVyQ291bnQgLSBpKSk7XG4gICAgICAgIH1cbiAgICAgICAgdm0uY2FsbChibG9jay5oYW5kbGUpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7IEdsaW1tZXJEZWJ1ZzogYDxpbnZva2UtZHluYW1pYy15aWVsZCBjYWxsZXItY291bnQ9JHt0aGlzLmNhbGxlckNvdW50fT5gIH07XG4gICAgfVxufVxuU1RBVEVNRU5UUy5hZGQoT3BzLllpZWxkLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCB0bywgcGFyYW1zXSA9IHNleHA7XG4gICAgbGV0IGNvdW50ID0gY29tcGlsZUxpc3QocGFyYW1zLCBidWlsZGVyKTtcbiAgICBidWlsZGVyLmdldEJsb2NrKHRvKTtcbiAgICBidWlsZGVyLmNvbXBpbGVEeW5hbWljQmxvY2soKTtcbiAgICBidWlsZGVyLmludm9rZUR5bmFtaWMobmV3IEludm9rZUR5bmFtaWNZaWVsZChjb3VudCkpO1xuICAgIGJ1aWxkZXIucG9wU2NvcGUoKTtcbiAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgaWYgKGNvdW50KSB7XG4gICAgICAgIGJ1aWxkZXIucG9wKGNvdW50KTtcbiAgICB9XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5EZWJ1Z2dlciwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgZXZhbEluZm9dID0gc2V4cDtcbiAgICBidWlsZGVyLmRlYnVnZ2VyKGJ1aWxkZXIubWV0YS5zeW1ib2xzLCBldmFsSW5mbyk7XG59KTtcblNUQVRFTUVOVFMuYWRkKE9wcy5DbGllbnRTaWRlU3RhdGVtZW50LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIENMSUVOVF9TSURFLmNvbXBpbGUoc2V4cCwgYnVpbGRlcik7XG59KTtcbmNvbnN0IEVYUFJFU1NJT05TID0gbmV3IENvbXBpbGVycygpO1xuY29uc3QgQ0xJRU5UX1NJREVfRVhQUlMgPSBuZXcgQ29tcGlsZXJzKDEpO1xudmFyIEUgPSBXaXJlRm9ybWF0LkV4cHJlc3Npb25zO1xuZXhwb3J0IGZ1bmN0aW9uIGV4cHIoZXhwcmVzc2lvbiwgYnVpbGRlcikge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGV4cHJlc3Npb24pKSB7XG4gICAgICAgIEVYUFJFU1NJT05TLmNvbXBpbGUoZXhwcmVzc2lvbiwgYnVpbGRlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnVpbGRlci5wcmltaXRpdmUoZXhwcmVzc2lvbik7XG4gICAgfVxufVxuRVhQUkVTU0lPTlMuYWRkKE9wcy5Vbmtub3duLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBuYW1lID0gc2V4cFsxXTtcbiAgICBpZiAoYnVpbGRlci5lbnYuaGFzSGVscGVyKG5hbWUsIGJ1aWxkZXIubWV0YS50ZW1wbGF0ZU1ldGEpKSB7XG4gICAgICAgIEVYUFJFU1NJT05TLmNvbXBpbGUoW09wcy5IZWxwZXIsIG5hbWUsIEVNUFRZX0FSUkFZLCBudWxsXSwgYnVpbGRlcik7XG4gICAgfSBlbHNlIGlmIChidWlsZGVyLm1ldGEuYXNQYXJ0aWFsKSB7XG4gICAgICAgIGJ1aWxkZXIucmVzb2x2ZU1heWJlTG9jYWwobmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnVpbGRlci5nZXRWYXJpYWJsZSgwKTtcbiAgICAgICAgYnVpbGRlci5nZXRQcm9wZXJ0eShuYW1lKTtcbiAgICB9XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuQ29uY2F0LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBwYXJ0cyA9IHNleHBbMV07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBleHByKHBhcnRzW2ldLCBidWlsZGVyKTtcbiAgICB9XG4gICAgYnVpbGRlci5jb25jYXQocGFydHMubGVuZ3RoKTtcbn0pO1xuQ0xJRU5UX1NJREVfRVhQUlMuYWRkKENsaWVudFNpZGUuT3BzLkZ1bmN0aW9uRXhwcmVzc2lvbiwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmZ1bmN0aW9uKHNleHBbMl0pO1xufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLkhlbHBlciwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgeyBlbnYsIG1ldGEgfSA9IGJ1aWxkZXI7XG4gICAgbGV0IFssIG5hbWUsIHBhcmFtcywgaGFzaF0gPSBzZXhwO1xuICAgIGlmIChlbnYuaGFzSGVscGVyKG5hbWUsIG1ldGEudGVtcGxhdGVNZXRhKSkge1xuICAgICAgICBidWlsZGVyLmNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgdHJ1ZSk7XG4gICAgICAgIGJ1aWxkZXIuaGVscGVyKGVudi5sb29rdXBIZWxwZXIobmFtZSwgbWV0YS50ZW1wbGF0ZU1ldGEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBpbGUgRXJyb3I6ICR7bmFtZX0gaXMgbm90IGEgaGVscGVyYCk7XG4gICAgfVxufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLkdldCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgaGVhZCwgcGF0aF0gPSBzZXhwO1xuICAgIGJ1aWxkZXIuZ2V0VmFyaWFibGUoaGVhZCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJ1aWxkZXIuZ2V0UHJvcGVydHkocGF0aFtpXSk7XG4gICAgfVxufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLk1heWJlTG9jYWwsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHBhdGhdID0gc2V4cDtcbiAgICBpZiAoYnVpbGRlci5tZXRhLmFzUGFydGlhbCkge1xuICAgICAgICBsZXQgaGVhZCA9IHBhdGhbMF07XG4gICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xuICAgICAgICBidWlsZGVyLnJlc29sdmVNYXliZUxvY2FsKGhlYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1aWxkZXIuZ2V0VmFyaWFibGUoMCk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0aC5sZW5ndGg7IGkrKykge1xuICAgICAgICBidWlsZGVyLmdldFByb3BlcnR5KHBhdGhbaV0pO1xuICAgIH1cbn0pO1xuRVhQUkVTU0lPTlMuYWRkKE9wcy5VbmRlZmluZWQsIChfc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIHJldHVybiBidWlsZGVyLnByaW1pdGl2ZSh1bmRlZmluZWQpO1xufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLkhhc0Jsb2NrLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuaGFzQmxvY2soc2V4cFsxXSk7XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuSGFzQmxvY2tQYXJhbXMsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5oYXNCbG9ja1BhcmFtcyhzZXhwWzFdKTtcbn0pO1xuRVhQUkVTU0lPTlMuYWRkKE9wcy5DbGllbnRTaWRlRXhwcmVzc2lvbiwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBDTElFTlRfU0lERV9FWFBSUy5jb21waWxlKHNleHAsIGJ1aWxkZXIpO1xufSk7XG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZUxpc3QocGFyYW1zLCBidWlsZGVyKSB7XG4gICAgaWYgKCFwYXJhbXMpIHJldHVybiAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGV4cHIocGFyYW1zW2ldLCBidWlsZGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmFtcy5sZW5ndGg7XG59XG5leHBvcnQgY2xhc3MgQmxvY2tzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5uYW1lcyA9IGRpY3QoKTtcbiAgICAgICAgdGhpcy5mdW5jcyA9IFtdO1xuICAgIH1cbiAgICBhZGQobmFtZSwgZnVuYykge1xuICAgICAgICB0aGlzLmZ1bmNzLnB1c2goZnVuYyk7XG4gICAgICAgIHRoaXMubmFtZXNbbmFtZV0gPSB0aGlzLmZ1bmNzLmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIGFkZE1pc3NpbmcoZnVuYykge1xuICAgICAgICB0aGlzLm1pc3NpbmcgPSBmdW5jO1xuICAgIH1cbiAgICBjb21waWxlKG5hbWUsIHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5uYW1lc1tuYW1lXTtcbiAgICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGFzc2VydCghIXRoaXMubWlzc2luZywgYCR7bmFtZX0gbm90IGZvdW5kLCBhbmQgbm8gY2F0Y2gtYWxsIGJsb2NrIGhhbmRsZXIgd2FzIHJlZ2lzdGVyZWRgKTtcbiAgICAgICAgICAgIGxldCBmdW5jID0gdGhpcy5taXNzaW5nO1xuICAgICAgICAgICAgbGV0IGhhbmRsZWQgPSBmdW5jKG5hbWUsIHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpO1xuICAgICAgICAgICAgYXNzZXJ0KCEhaGFuZGxlZCwgYCR7bmFtZX0gbm90IGZvdW5kLCBhbmQgdGhlIGNhdGNoLWFsbCBibG9jayBoYW5kbGVyIGRpZG4ndCBoYW5kbGUgaXRgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBmdW5jID0gdGhpcy5mdW5jc1tpbmRleF07XG4gICAgICAgICAgICBmdW5jKHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IEJMT0NLUyA9IG5ldyBCbG9ja3MoKTtcbmV4cG9ydCBjbGFzcyBJbmxpbmVzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5uYW1lcyA9IGRpY3QoKTtcbiAgICAgICAgdGhpcy5mdW5jcyA9IFtdO1xuICAgIH1cbiAgICBhZGQobmFtZSwgZnVuYykge1xuICAgICAgICB0aGlzLmZ1bmNzLnB1c2goZnVuYyk7XG4gICAgICAgIHRoaXMubmFtZXNbbmFtZV0gPSB0aGlzLmZ1bmNzLmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIGFkZE1pc3NpbmcoZnVuYykge1xuICAgICAgICB0aGlzLm1pc3NpbmcgPSBmdW5jO1xuICAgIH1cbiAgICBjb21waWxlKHNleHAsIGJ1aWxkZXIpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gc2V4cFsxXTtcbiAgICAgICAgLy8gVE9ETzogRml4IHRoaXMgc28gdGhhdCBleHByZXNzaW9uIG1hY3JvcyBjYW4gcmV0dXJuXG4gICAgICAgIC8vIHRoaW5ncyBsaWtlIGNvbXBvbmVudHMsIHNvIHRoYXQge3tjb21wb25lbnQgZm9vfX1cbiAgICAgICAgLy8gaXMgdGhlIHNhbWUgYXMge3soY29tcG9uZW50IGZvbyl9fVxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSByZXR1cm4gWydleHByJywgdmFsdWVdO1xuICAgICAgICBsZXQgbmFtZTtcbiAgICAgICAgbGV0IHBhcmFtcztcbiAgICAgICAgbGV0IGhhc2g7XG4gICAgICAgIGlmICh2YWx1ZVswXSA9PT0gT3BzLkhlbHBlcikge1xuICAgICAgICAgICAgbmFtZSA9IHZhbHVlWzFdO1xuICAgICAgICAgICAgcGFyYW1zID0gdmFsdWVbMl07XG4gICAgICAgICAgICBoYXNoID0gdmFsdWVbM107XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWVbMF0gPT09IE9wcy5Vbmtub3duKSB7XG4gICAgICAgICAgICBuYW1lID0gdmFsdWVbMV07XG4gICAgICAgICAgICBwYXJhbXMgPSBoYXNoID0gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbJ2V4cHInLCB2YWx1ZV07XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5uYW1lc1tuYW1lXTtcbiAgICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQgJiYgdGhpcy5taXNzaW5nKSB7XG4gICAgICAgICAgICBsZXQgZnVuYyA9IHRoaXMubWlzc2luZztcbiAgICAgICAgICAgIGxldCByZXR1cm5lZCA9IGZ1bmMobmFtZSwgcGFyYW1zLCBoYXNoLCBidWlsZGVyKTtcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5lZCA9PT0gZmFsc2UgPyBbJ2V4cHInLCB2YWx1ZV0gOiByZXR1cm5lZDtcbiAgICAgICAgfSBlbHNlIGlmIChpbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBsZXQgZnVuYyA9IHRoaXMuZnVuY3NbaW5kZXhdO1xuICAgICAgICAgICAgbGV0IHJldHVybmVkID0gZnVuYyhuYW1lLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHJldHVybmVkID09PSBmYWxzZSA/IFsnZXhwcicsIHZhbHVlXSA6IHJldHVybmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydCBjb25zdCBJTkxJTkVTID0gbmV3IElubGluZXMoKTtcbnBvcHVsYXRlQnVpbHRpbnMoQkxPQ0tTLCBJTkxJTkVTKTtcbmV4cG9ydCBmdW5jdGlvbiBwb3B1bGF0ZUJ1aWx0aW5zKGJsb2NrcyA9IG5ldyBCbG9ja3MoKSwgaW5saW5lcyA9IG5ldyBJbmxpbmVzKCkpIHtcbiAgICBibG9ja3MuYWRkKCdpZicsIChwYXJhbXMsIF9oYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgICAgICAvLyAgICAgICAgUHV0QXJnc1xuICAgICAgICAvLyAgICAgICAgVGVzdChFbnZpcm9ubWVudClcbiAgICAgICAgLy8gICAgICAgIEVudGVyKEJFR0lOLCBFTkQpXG4gICAgICAgIC8vIEJFR0lOOiBOb29wXG4gICAgICAgIC8vICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXG4gICAgICAgIC8vICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxuICAgICAgICAvLyAgICAgICAgSnVtcChFTkQpXG4gICAgICAgIC8vIEVMU0U6ICBOb29wXG4gICAgICAgIC8vICAgICAgICBFdmFsdWxhdGUoaW52ZXJzZSlcbiAgICAgICAgLy8gRU5EOiAgIE5vb3BcbiAgICAgICAgLy8gICAgICAgIEV4aXRcbiAgICAgICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICNpZiByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcbiAgICAgICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgICAgIGV4cHIocGFyYW1zWzBdLCBidWlsZGVyKTtcbiAgICAgICAgYnVpbGRlci50ZXN0KCdlbnZpcm9ubWVudCcpO1xuICAgICAgICBidWlsZGVyLmVudGVyKDEpO1xuICAgICAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSk7XG4gICAgICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICAgICAgICBidWlsZGVyLmp1bXAoJ0VYSVQnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKGludmVyc2UpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgICAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICAgIH0pO1xuICAgIGJsb2Nrcy5hZGQoJ3VubGVzcycsIChwYXJhbXMsIF9oYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgICAgICAvLyAgICAgICAgUHV0QXJnc1xuICAgICAgICAvLyAgICAgICAgVGVzdChFbnZpcm9ubWVudClcbiAgICAgICAgLy8gICAgICAgIEVudGVyKEJFR0lOLCBFTkQpXG4gICAgICAgIC8vIEJFR0lOOiBOb29wXG4gICAgICAgIC8vICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXG4gICAgICAgIC8vICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxuICAgICAgICAvLyAgICAgICAgSnVtcChFTkQpXG4gICAgICAgIC8vIEVMU0U6ICBOb29wXG4gICAgICAgIC8vICAgICAgICBFdmFsdWxhdGUoaW52ZXJzZSlcbiAgICAgICAgLy8gRU5EOiAgIE5vb3BcbiAgICAgICAgLy8gICAgICAgIEV4aXRcbiAgICAgICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICN1bmxlc3MgcmVxdWlyZXMgYSBzaW5nbGUgYXJndW1lbnRgKTtcbiAgICAgICAgfVxuICAgICAgICBidWlsZGVyLnN0YXJ0TGFiZWxzKCk7XG4gICAgICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIucmV0dXJuVG8oJ0VORCcpO1xuICAgICAgICBleHByKHBhcmFtc1swXSwgYnVpbGRlcik7XG4gICAgICAgIGJ1aWxkZXIudGVzdCgnZW52aXJvbm1lbnQnKTtcbiAgICAgICAgYnVpbGRlci5lbnRlcigxKTtcbiAgICAgICAgYnVpbGRlci5qdW1wSWYoJ0VMU0UnKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSk7XG4gICAgICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICAgICAgICBidWlsZGVyLmp1bXAoJ0VYSVQnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKGludmVyc2UpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgICAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICAgIH0pO1xuICAgIGJsb2Nrcy5hZGQoJ3dpdGgnLCAocGFyYW1zLCBfaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpID0+IHtcbiAgICAgICAgLy8gICAgICAgIFB1dEFyZ3NcbiAgICAgICAgLy8gICAgICAgIFRlc3QoRW52aXJvbm1lbnQpXG4gICAgICAgIC8vICAgICAgICBFbnRlcihCRUdJTiwgRU5EKVxuICAgICAgICAvLyBCRUdJTjogTm9vcFxuICAgICAgICAvLyAgICAgICAgSnVtcFVubGVzcyhFTFNFKVxuICAgICAgICAvLyAgICAgICAgRXZhbHVhdGUoZGVmYXVsdClcbiAgICAgICAgLy8gICAgICAgIEp1bXAoRU5EKVxuICAgICAgICAvLyBFTFNFOiAgTm9vcFxuICAgICAgICAvLyAgICAgICAgRXZhbHVsYXRlKGludmVyc2UpXG4gICAgICAgIC8vIEVORDogICBOb29wXG4gICAgICAgIC8vICAgICAgICBFeGl0XG4gICAgICAgIGlmICghcGFyYW1zIHx8IHBhcmFtcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU1lOVEFYIEVSUk9SOiAjd2l0aCByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcbiAgICAgICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgICAgIGV4cHIocGFyYW1zWzBdLCBidWlsZGVyKTtcbiAgICAgICAgYnVpbGRlci5kdXAoKTtcbiAgICAgICAgYnVpbGRlci50ZXN0KCdlbnZpcm9ubWVudCcpO1xuICAgICAgICBidWlsZGVyLmVudGVyKDIpO1xuICAgICAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSwgMSk7XG4gICAgICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICAgICAgICBidWlsZGVyLmp1bXAoJ0VYSVQnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKGludmVyc2UpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgICAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICAgIH0pO1xuICAgIGJsb2Nrcy5hZGQoJ2VhY2gnLCAocGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgICAgICAvLyAgICAgICAgIEVudGVyKEJFR0lOLCBFTkQpXG4gICAgICAgIC8vIEJFR0lOOiAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIFB1dEFyZ3NcbiAgICAgICAgLy8gICAgICAgICBQdXRJdGVyYWJsZVxuICAgICAgICAvLyAgICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcbiAgICAgICAgLy8gICAgICAgICBFbnRlckxpc3QoQkVHSU4yLCBFTkQyKVxuICAgICAgICAvLyBJVEVSOiAgIE5vb3BcbiAgICAgICAgLy8gICAgICAgICBOZXh0SXRlcihCUkVBSylcbiAgICAgICAgLy8gQkVHSU4yOiBOb29wXG4gICAgICAgIC8vICAgICAgICAgUHVzaENoaWxkU2NvcGVcbiAgICAgICAgLy8gICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxuICAgICAgICAvLyAgICAgICAgIFBvcFNjb3BlXG4gICAgICAgIC8vIEVORDI6ICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIEV4aXRcbiAgICAgICAgLy8gICAgICAgICBKdW1wKElURVIpXG4gICAgICAgIC8vIEJSRUFLOiAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIEV4aXRMaXN0XG4gICAgICAgIC8vICAgICAgICAgSnVtcChFTkQpXG4gICAgICAgIC8vIEVMU0U6ICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxuICAgICAgICAvLyBFTkQ6ICAgIE5vb3BcbiAgICAgICAgLy8gICAgICAgICBFeGl0XG4gICAgICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcbiAgICAgICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgICAgIGlmIChoYXNoICYmIGhhc2hbMF1bMF0gPT09ICdrZXknKSB7XG4gICAgICAgICAgICBleHByKGhhc2hbMV1bMF0sIGJ1aWxkZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5wcmltaXRpdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZXhwcihwYXJhbXNbMF0sIGJ1aWxkZXIpO1xuICAgICAgICBidWlsZGVyLmVudGVyKDIpO1xuICAgICAgICBidWlsZGVyLnB1dEl0ZXJhdG9yKCk7XG4gICAgICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRUxTRScpO1xuICAgICAgICBidWlsZGVyLnB1c2hGcmFtZSgpO1xuICAgICAgICBidWlsZGVyLnJldHVyblRvKCdJVEVSJyk7XG4gICAgICAgIGJ1aWxkZXIuZHVwKFJlZ2lzdGVyLmZwLCAxKTtcbiAgICAgICAgYnVpbGRlci5lbnRlckxpc3QoJ0JPRFknKTtcbiAgICAgICAgYnVpbGRlci5sYWJlbCgnSVRFUicpO1xuICAgICAgICBidWlsZGVyLml0ZXJhdGUoJ0JSRUFLJyk7XG4gICAgICAgIGJ1aWxkZXIubGFiZWwoJ0JPRFknKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSwgMik7XG4gICAgICAgIGJ1aWxkZXIucG9wKDIpO1xuICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICAgICAgYnVpbGRlci5sYWJlbCgnQlJFQUsnKTtcbiAgICAgICAgYnVpbGRlci5leGl0TGlzdCgpO1xuICAgICAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICAgICAgICBidWlsZGVyLmp1bXAoJ0VYSVQnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKGludmVyc2UpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgICAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICAgIH0pO1xuICAgIGJsb2Nrcy5hZGQoJy1pbi1lbGVtZW50JywgKHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIF9pbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgICAgIGlmICghcGFyYW1zIHx8IHBhcmFtcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU1lOVEFYIEVSUk9SOiAjLWluLWVsZW1lbnQgcmVxdWlyZXMgYSBzaW5nbGUgYXJndW1lbnRgKTtcbiAgICAgICAgfVxuICAgICAgICBidWlsZGVyLnN0YXJ0TGFiZWxzKCk7XG4gICAgICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIucmV0dXJuVG8oJ0VORCcpO1xuICAgICAgICBpZiAoaGFzaCAmJiBoYXNoWzBdLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IFtrZXlzLCB2YWx1ZXNdID0gaGFzaDtcbiAgICAgICAgICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMSAmJiBrZXlzWzBdID09PSAnbmV4dFNpYmxpbmcnKSB7XG4gICAgICAgICAgICAgICAgZXhwcih2YWx1ZXNbMF0sIGJ1aWxkZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNZTlRBWCBFUlJPUjogIy1pbi1lbGVtZW50IGRvZXMgbm90IHRha2UgYSBcXGAke2tleXNbMF19XFxgIG9wdGlvbmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwcihudWxsLCBidWlsZGVyKTtcbiAgICAgICAgfVxuICAgICAgICBleHByKHBhcmFtc1swXSwgYnVpbGRlcik7XG4gICAgICAgIGJ1aWxkZXIuZHVwKCk7XG4gICAgICAgIGJ1aWxkZXIudGVzdCgnc2ltcGxlJyk7XG4gICAgICAgIGJ1aWxkZXIuZW50ZXIoMyk7XG4gICAgICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRUxTRScpO1xuICAgICAgICBidWlsZGVyLnB1c2hSZW1vdGVFbGVtZW50KCk7XG4gICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKHVud3JhcCh0ZW1wbGF0ZSkpO1xuICAgICAgICBidWlsZGVyLnBvcFJlbW90ZUVsZW1lbnQoKTtcbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gICAgfSk7XG4gICAgYmxvY2tzLmFkZCgnLXdpdGgtZHluYW1pYy12YXJzJywgKF9wYXJhbXMsIGhhc2gsIHRlbXBsYXRlLCBfaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgICAgICBpZiAoaGFzaCkge1xuICAgICAgICAgICAgbGV0IFtuYW1lcywgZXhwcmVzc2lvbnNdID0gaGFzaDtcbiAgICAgICAgICAgIGNvbXBpbGVMaXN0KGV4cHJlc3Npb25zLCBidWlsZGVyKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucHVzaER5bmFtaWNTY29wZSgpO1xuICAgICAgICAgICAgYnVpbGRlci5iaW5kRHluYW1pY1Njb3BlKG5hbWVzKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKHVud3JhcCh0ZW1wbGF0ZSkpO1xuICAgICAgICAgICAgYnVpbGRlci5wb3BEeW5hbWljU2NvcGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljKHVud3JhcCh0ZW1wbGF0ZSkpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgYmxvY2tzLCBpbmxpbmVzIH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVN0YXRlbWVudChzdGF0ZW1lbnQsIGJ1aWxkZXIpIHtcbiAgICBTVEFURU1FTlRTLmNvbXBpbGUoc3RhdGVtZW50LCBidWlsZGVyKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlU3RhdGVtZW50cyhzdGF0ZW1lbnRzLCBtZXRhLCBlbnYpIHtcbiAgICBsZXQgYiA9IG5ldyBPcGNvZGVCdWlsZGVyKGVudiwgbWV0YSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbXBpbGVTdGF0ZW1lbnQoc3RhdGVtZW50c1tpXSwgYik7XG4gICAgfVxuICAgIHJldHVybiBiO1xufSJdfQ==