'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.INLINES = exports.Inlines = exports.BLOCKS = exports.Blocks = exports.PartialInvoker = exports.InvokeDynamicLayout = exports.ATTRS_BLOCK = undefined;
exports.expr = expr;
exports.compileList = compileList;
exports.populateBuiltins = populateBuiltins;
exports.compileStatement = compileStatement;
exports.compileStatements = compileStatements;

var _reference = require('@glimmer/reference');

var _util = require('@glimmer/util');

var _wireFormat = require('@glimmer/wire-format');

var WireFormat = _interopRequireWildcard(_wireFormat);

var _builder = require('../compiled/opcodes/builder');

var _builder2 = _interopRequireDefault(_builder);

var _opcodes = require('../opcodes');

var _clientSide = require('../syntax/client-side');

var ClientSide = _interopRequireWildcard(_clientSide);

var _rawBlock = require('./raw-block');

var _rawBlock2 = _interopRequireDefault(_rawBlock);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
    }
}

var Ops = WireFormat.Ops;
var ATTRS_BLOCK = exports.ATTRS_BLOCK = '&attrs';

var Compilers = function () {
    function Compilers() {
        var offset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

        _classCallCheck(this, Compilers);

        this.offset = offset;
        this.names = (0, _util.dict)();
        this.funcs = [];
    }

    Compilers.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Compilers.prototype.compile = function compile(sexp, builder) {
        var name = sexp[this.offset];
        var index = this.names[name];
        var func = this.funcs[index];
        (0, _util.assert)(!!func, 'expected an implementation for ' + (this.offset === 0 ? Ops[sexp[0]] : ClientSide.Ops[sexp[1]]));
        func(sexp, builder);
    };

    return Compilers;
}();

var STATEMENTS = new Compilers();
var CLIENT_SIDE = new Compilers(1);
STATEMENTS.add(Ops.Text, function (sexp, builder) {
    builder.text(sexp[1]);
});
STATEMENTS.add(Ops.Comment, function (sexp, builder) {
    builder.comment(sexp[1]);
});
STATEMENTS.add(Ops.CloseElement, function (_sexp, builder) {
    builder.closeElement();
});
STATEMENTS.add(Ops.FlushElement, function (_sexp, builder) {
    builder.flushElement();
});
STATEMENTS.add(Ops.Modifier, function (sexp, builder) {
    var env = builder.env,
        meta = builder.meta;
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3];

    if (env.hasModifier(name, meta.templateMeta)) {
        builder.compileArgs(params, hash, true);
        builder.modifier(env.lookupModifier(name, meta.templateMeta));
    } else {
        throw new Error('Compile Error ' + name + ' is not a modifier: Helpers may not be used in the element form.');
    }
});
STATEMENTS.add(Ops.StaticAttr, function (sexp, builder) {
    var name = sexp[1],
        value = sexp[2],
        namespace = sexp[3];

    builder.staticAttr(name, namespace, value);
});
STATEMENTS.add(Ops.DynamicAttr, function (sexp, builder) {
    dynamicAttr(sexp, false, builder);
});
STATEMENTS.add(Ops.TrustingAttr, function (sexp, builder) {
    dynamicAttr(sexp, true, builder);
});
function dynamicAttr(sexp, trusting, builder) {
    var name = sexp[1],
        value = sexp[2],
        namespace = sexp[3];

    expr(value, builder);
    if (namespace) {
        builder.dynamicAttrNS(name, namespace, trusting);
    } else {
        builder.dynamicAttr(name, trusting);
    }
}
STATEMENTS.add(Ops.OpenElement, function (sexp, builder) {
    builder.openPrimitiveElement(sexp[1]);
});
CLIENT_SIDE.add(ClientSide.Ops.OpenComponentElement, function (sexp, builder) {
    builder.pushComponentOperations();
    builder.openElementWithOperations(sexp[2]);
});
CLIENT_SIDE.add(ClientSide.Ops.DidCreateElement, function (_sexp, builder) {
    builder.didCreateElement(_opcodes.Register.s0);
});
CLIENT_SIDE.add(ClientSide.Ops.DidRenderLayout, function (_sexp, builder) {
    builder.didRenderLayout(_opcodes.Register.s0);
});
STATEMENTS.add(Ops.Append, function (sexp, builder) {
    var value = sexp[1],
        trusting = sexp[2];

    var _builder$env$macros = builder.env.macros(),
        inlines = _builder$env$macros.inlines;

    var returned = inlines.compile(sexp, builder) || value;
    if (returned === true) return;
    var isGet = E.isGet(value);
    var isMaybeLocal = E.isMaybeLocal(value);
    if (trusting) {
        builder.guardedAppend(value, true);
    } else {
        if (isGet || isMaybeLocal) {
            builder.guardedAppend(value, false);
        } else {
            expr(value, builder);
            builder.cautiousAppend();
        }
    }
});
STATEMENTS.add(Ops.Block, function (sexp, builder) {
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3],
        _template = sexp[4],
        _inverse = sexp[5];

    var template = builder.template(_template);
    var inverse = builder.template(_inverse);
    var templateBlock = template && template.scan();
    var inverseBlock = inverse && inverse.scan();

    var _builder$env$macros2 = builder.env.macros(),
        blocks = _builder$env$macros2.blocks;

    blocks.compile(name, params, hash, templateBlock, inverseBlock, builder);
});
var InvokeDynamicLayout = exports.InvokeDynamicLayout = function () {
    function InvokeDynamicLayout(attrs) {
        _classCallCheck(this, InvokeDynamicLayout);

        this.attrs = attrs;
    }

    InvokeDynamicLayout.prototype.invoke = function invoke(vm, layout) {
        var _layout$symbolTable = layout.symbolTable,
            symbols = _layout$symbolTable.symbols,
            hasEval = _layout$symbolTable.hasEval;

        var stack = vm.stack;
        var scope = vm.pushRootScope(symbols.length + 1, true);
        scope.bindSelf(stack.pop());
        scope.bindBlock(symbols.indexOf(ATTRS_BLOCK) + 1, this.attrs);
        var lookup = null;
        var $eval = -1;
        if (hasEval) {
            $eval = symbols.indexOf('$eval') + 1;
            lookup = (0, _util.dict)();
        }
        var callerNames = stack.pop();
        for (var i = callerNames.length - 1; i >= 0; i--) {
            var symbol = symbols.indexOf(callerNames[i]);
            var value = stack.pop();
            if (symbol !== -1) scope.bindSymbol(symbol + 1, value);
            if (hasEval) lookup[callerNames[i]] = value;
        }
        var numPositionalArgs = stack.pop();
        (0, _util.assert)(typeof numPositionalArgs === 'number', '[BUG] Incorrect value of positional argument count found during invoke-dynamic-layout.');
        // Currently we don't support accessing positional args in templates, so just throw them away
        stack.pop(numPositionalArgs);
        var inverseSymbol = symbols.indexOf('&inverse');
        var inverse = stack.pop();
        if (inverseSymbol !== -1) {
            scope.bindBlock(inverseSymbol + 1, inverse);
        }
        if (lookup) lookup['&inverse'] = inverse;
        var defaultSymbol = symbols.indexOf('&default');
        var defaultBlock = stack.pop();
        if (defaultSymbol !== -1) {
            scope.bindBlock(defaultSymbol + 1, defaultBlock);
        }
        if (lookup) lookup['&default'] = defaultBlock;
        if (lookup) scope.bindEvalScope(lookup);
        vm.pushFrame();
        vm.call(layout.handle);
    };

    InvokeDynamicLayout.prototype.toJSON = function toJSON() {
        return { GlimmerDebug: '<invoke-dynamic-layout>' };
    };

    return InvokeDynamicLayout;
}();
STATEMENTS.add(Ops.Component, function (sexp, builder) {
    var tag = sexp[1],
        attrs = sexp[2],
        args = sexp[3],
        block = sexp[4];

    if (builder.env.hasComponentDefinition(tag, builder.meta.templateMeta)) {
        var child = builder.template(block);
        var attrsBlock = new _rawBlock2.default(builder.meta, attrs, _util.EMPTY_ARRAY);
        var definition = builder.env.getComponentDefinition(tag, builder.meta.templateMeta);
        builder.pushComponentManager(definition);
        builder.invokeComponent(attrsBlock, null, args, child && child.scan());
    } else if (block && block.parameters.length) {
        throw new Error('Compile Error: Cannot find component ' + tag);
    } else {
        builder.openPrimitiveElement(tag);
        for (var i = 0; i < attrs.length; i++) {
            STATEMENTS.compile(attrs[i], builder);
        }
        builder.flushElement();
        if (block) {
            var stmts = block.statements;
            for (var _i = 0; _i < stmts.length; _i++) {
                STATEMENTS.compile(stmts[_i], builder);
            }
        }
        builder.closeElement();
    }
});
var PartialInvoker = exports.PartialInvoker = function () {
    function PartialInvoker(outerSymbols, evalInfo) {
        _classCallCheck(this, PartialInvoker);

        this.outerSymbols = outerSymbols;
        this.evalInfo = evalInfo;
    }

    PartialInvoker.prototype.invoke = function invoke(vm, _partial) {
        var partial = _partial;
        var partialSymbols = partial.symbolTable.symbols;
        var outerScope = vm.scope();
        var partialScope = vm.pushRootScope(partialSymbols.length, false);
        partialScope.bindCallerScope(outerScope.getCallerScope());
        partialScope.bindEvalScope(outerScope.getEvalScope());
        partialScope.bindSelf(outerScope.getSelf());
        var evalInfo = this.evalInfo,
            outerSymbols = this.outerSymbols;

        var locals = (0, _util.dict)();
        for (var i = 0; i < evalInfo.length; i++) {
            var slot = evalInfo[i];
            var name = outerSymbols[slot - 1];
            var ref = outerScope.getSymbol(slot);
            locals[name] = ref;
        }
        var evalScope = outerScope.getEvalScope();
        for (var _i2 = 0; _i2 < partialSymbols.length; _i2++) {
            var _name = partialSymbols[_i2];
            var symbol = _i2 + 1;
            var value = evalScope[_name];
            if (value !== undefined) partialScope.bind(symbol, value);
        }
        partialScope.bindPartialMap(locals);
        vm.pushFrame();
        vm.call(partial.handle);
    };

    return PartialInvoker;
}();
STATEMENTS.add(Ops.Partial, function (sexp, builder) {
    var name = sexp[1],
        evalInfo = sexp[2];
    var _builder$meta = builder.meta,
        templateMeta = _builder$meta.templateMeta,
        symbols = _builder$meta.symbols;

    function helper(vm, args) {
        var env = vm.env;

        var nameRef = args.positional.at(0);
        return (0, _reference.map)(nameRef, function (n) {
            if (typeof n === 'string' && n) {
                if (!env.hasPartial(n, templateMeta)) {
                    throw new Error('Could not find a partial named "' + n + '"');
                }
                return env.lookupPartial(n, templateMeta);
            } else if (n) {
                throw new Error('Could not find a partial named "' + String(n) + '"');
            } else {
                return null;
            }
        });
    }
    builder.startLabels();
    builder.pushFrame();
    builder.returnTo('END');
    expr(name, builder);
    builder.pushImmediate(1);
    builder.pushImmediate(_util.EMPTY_ARRAY);
    builder.pushArgs(true);
    builder.helper(helper);
    builder.dup();
    builder.test('simple');
    builder.enter(2);
    builder.jumpUnless('ELSE');
    builder.getPartialTemplate();
    builder.compileDynamicBlock();
    builder.invokeDynamic(new PartialInvoker(symbols, evalInfo));
    builder.popScope();
    builder.popFrame();
    builder.label('ELSE');
    builder.exit();
    builder.return();
    builder.label('END');
    builder.popFrame();
    builder.stopLabels();
});

var InvokeDynamicYield = function () {
    function InvokeDynamicYield(callerCount) {
        _classCallCheck(this, InvokeDynamicYield);

        this.callerCount = callerCount;
    }

    InvokeDynamicYield.prototype.invoke = function invoke(vm, block) {
        var callerCount = this.callerCount;

        var stack = vm.stack;
        if (!block) {
            // To balance the pop{Frame,Scope}
            vm.pushFrame();
            vm.pushCallerScope();
            return;
        }
        var table = block.symbolTable;
        var locals = table.parameters; // always present in inline blocks
        var calleeCount = locals ? locals.length : 0;
        var count = Math.min(callerCount, calleeCount);
        vm.pushFrame();
        vm.pushCallerScope(calleeCount > 0);
        var scope = vm.scope();
        for (var i = 0; i < count; i++) {
            scope.bindSymbol(locals[i], stack.fromBase(callerCount - i));
        }
        vm.call(block.handle);
    };

    InvokeDynamicYield.prototype.toJSON = function toJSON() {
        return { GlimmerDebug: '<invoke-dynamic-yield caller-count=' + this.callerCount + '>' };
    };

    return InvokeDynamicYield;
}();

STATEMENTS.add(Ops.Yield, function (sexp, builder) {
    var to = sexp[1],
        params = sexp[2];

    var count = compileList(params, builder);
    builder.getBlock(to);
    builder.compileDynamicBlock();
    builder.invokeDynamic(new InvokeDynamicYield(count));
    builder.popScope();
    builder.popFrame();
    if (count) {
        builder.pop(count);
    }
});
STATEMENTS.add(Ops.Debugger, function (sexp, builder) {
    var evalInfo = sexp[1];

    builder.debugger(builder.meta.symbols, evalInfo);
});
STATEMENTS.add(Ops.ClientSideStatement, function (sexp, builder) {
    CLIENT_SIDE.compile(sexp, builder);
});
var EXPRESSIONS = new Compilers();
var CLIENT_SIDE_EXPRS = new Compilers(1);
var E = WireFormat.Expressions;
function expr(expression, builder) {
    if (Array.isArray(expression)) {
        EXPRESSIONS.compile(expression, builder);
    } else {
        builder.primitive(expression);
    }
}
EXPRESSIONS.add(Ops.Unknown, function (sexp, builder) {
    var name = sexp[1];
    if (builder.env.hasHelper(name, builder.meta.templateMeta)) {
        EXPRESSIONS.compile([Ops.Helper, name, _util.EMPTY_ARRAY, null], builder);
    } else if (builder.meta.asPartial) {
        builder.resolveMaybeLocal(name);
    } else {
        builder.getVariable(0);
        builder.getProperty(name);
    }
});
EXPRESSIONS.add(Ops.Concat, function (sexp, builder) {
    var parts = sexp[1];
    for (var i = 0; i < parts.length; i++) {
        expr(parts[i], builder);
    }
    builder.concat(parts.length);
});
CLIENT_SIDE_EXPRS.add(ClientSide.Ops.FunctionExpression, function (sexp, builder) {
    builder.function(sexp[2]);
});
EXPRESSIONS.add(Ops.Helper, function (sexp, builder) {
    var env = builder.env,
        meta = builder.meta;
    var name = sexp[1],
        params = sexp[2],
        hash = sexp[3];

    if (env.hasHelper(name, meta.templateMeta)) {
        builder.compileArgs(params, hash, true);
        builder.helper(env.lookupHelper(name, meta.templateMeta));
    } else {
        throw new Error('Compile Error: ' + name + ' is not a helper');
    }
});
EXPRESSIONS.add(Ops.Get, function (sexp, builder) {
    var head = sexp[1],
        path = sexp[2];

    builder.getVariable(head);
    for (var i = 0; i < path.length; i++) {
        builder.getProperty(path[i]);
    }
});
EXPRESSIONS.add(Ops.MaybeLocal, function (sexp, builder) {
    var path = sexp[1];

    if (builder.meta.asPartial) {
        var head = path[0];
        path = path.slice(1);
        builder.resolveMaybeLocal(head);
    } else {
        builder.getVariable(0);
    }
    for (var i = 0; i < path.length; i++) {
        builder.getProperty(path[i]);
    }
});
EXPRESSIONS.add(Ops.Undefined, function (_sexp, builder) {
    return builder.primitive(undefined);
});
EXPRESSIONS.add(Ops.HasBlock, function (sexp, builder) {
    builder.hasBlock(sexp[1]);
});
EXPRESSIONS.add(Ops.HasBlockParams, function (sexp, builder) {
    builder.hasBlockParams(sexp[1]);
});
EXPRESSIONS.add(Ops.ClientSideExpression, function (sexp, builder) {
    CLIENT_SIDE_EXPRS.compile(sexp, builder);
});
function compileList(params, builder) {
    if (!params) return 0;
    for (var i = 0; i < params.length; i++) {
        expr(params[i], builder);
    }
    return params.length;
}
var Blocks = exports.Blocks = function () {
    function Blocks() {
        _classCallCheck(this, Blocks);

        this.names = (0, _util.dict)();
        this.funcs = [];
    }

    Blocks.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Blocks.prototype.addMissing = function addMissing(func) {
        this.missing = func;
    };

    Blocks.prototype.compile = function compile(name, params, hash, template, inverse, builder) {
        var index = this.names[name];
        if (index === undefined) {
            (0, _util.assert)(!!this.missing, name + ' not found, and no catch-all block handler was registered');
            var func = this.missing;
            var handled = func(name, params, hash, template, inverse, builder);
            (0, _util.assert)(!!handled, name + ' not found, and the catch-all block handler didn\'t handle it');
        } else {
            var _func = this.funcs[index];
            _func(params, hash, template, inverse, builder);
        }
    };

    return Blocks;
}();
var BLOCKS = exports.BLOCKS = new Blocks();
var Inlines = exports.Inlines = function () {
    function Inlines() {
        _classCallCheck(this, Inlines);

        this.names = (0, _util.dict)();
        this.funcs = [];
    }

    Inlines.prototype.add = function add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    };

    Inlines.prototype.addMissing = function addMissing(func) {
        this.missing = func;
    };

    Inlines.prototype.compile = function compile(sexp, builder) {
        var value = sexp[1];
        // TODO: Fix this so that expression macros can return
        // things like components, so that {{component foo}}
        // is the same as {{(component foo)}}
        if (!Array.isArray(value)) return ['expr', value];
        var name = void 0;
        var params = void 0;
        var hash = void 0;
        if (value[0] === Ops.Helper) {
            name = value[1];
            params = value[2];
            hash = value[3];
        } else if (value[0] === Ops.Unknown) {
            name = value[1];
            params = hash = null;
        } else {
            return ['expr', value];
        }
        var index = this.names[name];
        if (index === undefined && this.missing) {
            var func = this.missing;
            var returned = func(name, params, hash, builder);
            return returned === false ? ['expr', value] : returned;
        } else if (index !== undefined) {
            var _func2 = this.funcs[index];
            var _returned = _func2(name, params, hash, builder);
            return _returned === false ? ['expr', value] : _returned;
        } else {
            return ['expr', value];
        }
    };

    return Inlines;
}();
var INLINES = exports.INLINES = new Inlines();
populateBuiltins(BLOCKS, INLINES);
function populateBuiltins() {
    var blocks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Blocks();
    var inlines = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Inlines();

    blocks.add('if', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #if requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.test('environment');
        builder.enter(1);
        builder.jumpUnless('ELSE');
        builder.invokeStatic(template);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('unless', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #unless requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.test('environment');
        builder.enter(1);
        builder.jumpIf('ELSE');
        builder.invokeStatic(template);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('with', function (params, _hash, template, inverse, builder) {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #with requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        expr(params[0], builder);
        builder.dup();
        builder.test('environment');
        builder.enter(2);
        builder.jumpUnless('ELSE');
        builder.invokeStatic(template, 1);
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('each', function (params, hash, template, inverse, builder) {
        //         Enter(BEGIN, END)
        // BEGIN:  Noop
        //         PutArgs
        //         PutIterable
        //         JumpUnless(ELSE)
        //         EnterList(BEGIN2, END2)
        // ITER:   Noop
        //         NextIter(BREAK)
        // BEGIN2: Noop
        //         PushChildScope
        //         Evaluate(default)
        //         PopScope
        // END2:   Noop
        //         Exit
        //         Jump(ITER)
        // BREAK:  Noop
        //         ExitList
        //         Jump(END)
        // ELSE:   Noop
        //         Evalulate(inverse)
        // END:    Noop
        //         Exit
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        if (hash && hash[0][0] === 'key') {
            expr(hash[1][0], builder);
        } else {
            builder.primitive(null);
        }
        expr(params[0], builder);
        builder.enter(2);
        builder.putIterator();
        builder.jumpUnless('ELSE');
        builder.pushFrame();
        builder.returnTo('ITER');
        builder.dup(_opcodes.Register.fp, 1);
        builder.enterList('BODY');
        builder.label('ITER');
        builder.iterate('BREAK');
        builder.label('BODY');
        builder.invokeStatic(template, 2);
        builder.pop(2);
        builder.exit();
        builder.return();
        builder.label('BREAK');
        builder.exitList();
        builder.popFrame();
        if (inverse) {
            builder.jump('EXIT');
            builder.label('ELSE');
            builder.invokeStatic(inverse);
            builder.label('EXIT');
            builder.exit();
            builder.return();
        } else {
            builder.label('ELSE');
            builder.exit();
            builder.return();
        }
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('-in-element', function (params, hash, template, _inverse, builder) {
        if (!params || params.length !== 1) {
            throw new Error('SYNTAX ERROR: #-in-element requires a single argument');
        }
        builder.startLabels();
        builder.pushFrame();
        builder.returnTo('END');
        if (hash && hash[0].length) {
            var keys = hash[0],
                values = hash[1];

            if (keys.length === 1 && keys[0] === 'nextSibling') {
                expr(values[0], builder);
            } else {
                throw new Error('SYNTAX ERROR: #-in-element does not take a `' + keys[0] + '` option');
            }
        } else {
            expr(null, builder);
        }
        expr(params[0], builder);
        builder.dup();
        builder.test('simple');
        builder.enter(3);
        builder.jumpUnless('ELSE');
        builder.pushRemoteElement();
        builder.invokeStatic(template);
        builder.popRemoteElement();
        builder.label('ELSE');
        builder.exit();
        builder.return();
        builder.label('END');
        builder.popFrame();
        builder.stopLabels();
    });
    blocks.add('-with-dynamic-vars', function (_params, hash, template, _inverse, builder) {
        if (hash) {
            var names = hash[0],
                expressions = hash[1];

            compileList(expressions, builder);
            builder.pushDynamicScope();
            builder.bindDynamicScope(names);
            builder.invokeStatic(template);
            builder.popDynamicScope();
        } else {
            builder.invokeStatic(template);
        }
    });
    return { blocks: blocks, inlines: inlines };
}
function compileStatement(statement, builder) {
    STATEMENTS.compile(statement, builder);
}
function compileStatements(statements, meta, env) {
    var b = new _builder2.default(env, meta);
    for (var i = 0; i < statements.length; i++) {
        compileStatement(statements[i], b);
    }
    return b;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zeW50YXgvZnVuY3Rpb25zLmpzIl0sIm5hbWVzIjpbIm1hcCIsImFzc2VydCIsImRpY3QiLCJFTVBUWV9BUlJBWSIsIldpcmVGb3JtYXQiLCJPcGNvZGVCdWlsZGVyIiwiUmVnaXN0ZXIiLCJDbGllbnRTaWRlIiwiUmF3SW5saW5lQmxvY2siLCJPcHMiLCJBVFRSU19CTE9DSyIsIkNvbXBpbGVycyIsIm9mZnNldCIsIm5hbWVzIiwiZnVuY3MiLCJhZGQiLCJuYW1lIiwiZnVuYyIsInB1c2giLCJsZW5ndGgiLCJjb21waWxlIiwic2V4cCIsImJ1aWxkZXIiLCJpbmRleCIsIlNUQVRFTUVOVFMiLCJDTElFTlRfU0lERSIsIlRleHQiLCJ0ZXh0IiwiQ29tbWVudCIsImNvbW1lbnQiLCJDbG9zZUVsZW1lbnQiLCJfc2V4cCIsImNsb3NlRWxlbWVudCIsIkZsdXNoRWxlbWVudCIsImZsdXNoRWxlbWVudCIsIk1vZGlmaWVyIiwiZW52IiwibWV0YSIsInBhcmFtcyIsImhhc2giLCJoYXNNb2RpZmllciIsInRlbXBsYXRlTWV0YSIsImNvbXBpbGVBcmdzIiwibW9kaWZpZXIiLCJsb29rdXBNb2RpZmllciIsIkVycm9yIiwiU3RhdGljQXR0ciIsInZhbHVlIiwibmFtZXNwYWNlIiwic3RhdGljQXR0ciIsIkR5bmFtaWNBdHRyIiwiZHluYW1pY0F0dHIiLCJUcnVzdGluZ0F0dHIiLCJ0cnVzdGluZyIsImV4cHIiLCJkeW5hbWljQXR0ck5TIiwiT3BlbkVsZW1lbnQiLCJvcGVuUHJpbWl0aXZlRWxlbWVudCIsIk9wZW5Db21wb25lbnRFbGVtZW50IiwicHVzaENvbXBvbmVudE9wZXJhdGlvbnMiLCJvcGVuRWxlbWVudFdpdGhPcGVyYXRpb25zIiwiRGlkQ3JlYXRlRWxlbWVudCIsImRpZENyZWF0ZUVsZW1lbnQiLCJzMCIsIkRpZFJlbmRlckxheW91dCIsImRpZFJlbmRlckxheW91dCIsIkFwcGVuZCIsIm1hY3JvcyIsImlubGluZXMiLCJyZXR1cm5lZCIsImlzR2V0IiwiRSIsImlzTWF5YmVMb2NhbCIsImd1YXJkZWRBcHBlbmQiLCJjYXV0aW91c0FwcGVuZCIsIkJsb2NrIiwiX3RlbXBsYXRlIiwiX2ludmVyc2UiLCJ0ZW1wbGF0ZSIsImludmVyc2UiLCJ0ZW1wbGF0ZUJsb2NrIiwic2NhbiIsImludmVyc2VCbG9jayIsImJsb2NrcyIsIkludm9rZUR5bmFtaWNMYXlvdXQiLCJhdHRycyIsImludm9rZSIsInZtIiwibGF5b3V0Iiwic3ltYm9sVGFibGUiLCJzeW1ib2xzIiwiaGFzRXZhbCIsInN0YWNrIiwic2NvcGUiLCJwdXNoUm9vdFNjb3BlIiwiYmluZFNlbGYiLCJwb3AiLCJiaW5kQmxvY2siLCJpbmRleE9mIiwibG9va3VwIiwiJGV2YWwiLCJjYWxsZXJOYW1lcyIsImkiLCJzeW1ib2wiLCJiaW5kU3ltYm9sIiwibnVtUG9zaXRpb25hbEFyZ3MiLCJpbnZlcnNlU3ltYm9sIiwiZGVmYXVsdFN5bWJvbCIsImRlZmF1bHRCbG9jayIsImJpbmRFdmFsU2NvcGUiLCJwdXNoRnJhbWUiLCJjYWxsIiwiaGFuZGxlIiwidG9KU09OIiwiR2xpbW1lckRlYnVnIiwiQ29tcG9uZW50IiwidGFnIiwiYXJncyIsImJsb2NrIiwiaGFzQ29tcG9uZW50RGVmaW5pdGlvbiIsImNoaWxkIiwiYXR0cnNCbG9jayIsImRlZmluaXRpb24iLCJnZXRDb21wb25lbnREZWZpbml0aW9uIiwicHVzaENvbXBvbmVudE1hbmFnZXIiLCJpbnZva2VDb21wb25lbnQiLCJwYXJhbWV0ZXJzIiwic3RtdHMiLCJzdGF0ZW1lbnRzIiwiUGFydGlhbEludm9rZXIiLCJvdXRlclN5bWJvbHMiLCJldmFsSW5mbyIsIl9wYXJ0aWFsIiwicGFydGlhbCIsInBhcnRpYWxTeW1ib2xzIiwib3V0ZXJTY29wZSIsInBhcnRpYWxTY29wZSIsImJpbmRDYWxsZXJTY29wZSIsImdldENhbGxlclNjb3BlIiwiZ2V0RXZhbFNjb3BlIiwiZ2V0U2VsZiIsImxvY2FscyIsInNsb3QiLCJyZWYiLCJnZXRTeW1ib2wiLCJldmFsU2NvcGUiLCJ1bmRlZmluZWQiLCJiaW5kIiwiYmluZFBhcnRpYWxNYXAiLCJQYXJ0aWFsIiwiaGVscGVyIiwibmFtZVJlZiIsInBvc2l0aW9uYWwiLCJhdCIsIm4iLCJoYXNQYXJ0aWFsIiwibG9va3VwUGFydGlhbCIsIlN0cmluZyIsInN0YXJ0TGFiZWxzIiwicmV0dXJuVG8iLCJwdXNoSW1tZWRpYXRlIiwicHVzaEFyZ3MiLCJkdXAiLCJ0ZXN0IiwiZW50ZXIiLCJqdW1wVW5sZXNzIiwiZ2V0UGFydGlhbFRlbXBsYXRlIiwiY29tcGlsZUR5bmFtaWNCbG9jayIsImludm9rZUR5bmFtaWMiLCJwb3BTY29wZSIsInBvcEZyYW1lIiwibGFiZWwiLCJleGl0IiwicmV0dXJuIiwic3RvcExhYmVscyIsIkludm9rZUR5bmFtaWNZaWVsZCIsImNhbGxlckNvdW50IiwicHVzaENhbGxlclNjb3BlIiwidGFibGUiLCJjYWxsZWVDb3VudCIsImNvdW50IiwiTWF0aCIsIm1pbiIsImZyb21CYXNlIiwiWWllbGQiLCJ0byIsImNvbXBpbGVMaXN0IiwiZ2V0QmxvY2siLCJEZWJ1Z2dlciIsImRlYnVnZ2VyIiwiQ2xpZW50U2lkZVN0YXRlbWVudCIsIkVYUFJFU1NJT05TIiwiQ0xJRU5UX1NJREVfRVhQUlMiLCJFeHByZXNzaW9ucyIsImV4cHJlc3Npb24iLCJBcnJheSIsImlzQXJyYXkiLCJwcmltaXRpdmUiLCJVbmtub3duIiwiaGFzSGVscGVyIiwiSGVscGVyIiwiYXNQYXJ0aWFsIiwicmVzb2x2ZU1heWJlTG9jYWwiLCJnZXRWYXJpYWJsZSIsImdldFByb3BlcnR5IiwiQ29uY2F0IiwicGFydHMiLCJjb25jYXQiLCJGdW5jdGlvbkV4cHJlc3Npb24iLCJmdW5jdGlvbiIsImxvb2t1cEhlbHBlciIsIkdldCIsImhlYWQiLCJwYXRoIiwiTWF5YmVMb2NhbCIsInNsaWNlIiwiVW5kZWZpbmVkIiwiSGFzQmxvY2siLCJoYXNCbG9jayIsIkhhc0Jsb2NrUGFyYW1zIiwiaGFzQmxvY2tQYXJhbXMiLCJDbGllbnRTaWRlRXhwcmVzc2lvbiIsIkJsb2NrcyIsImFkZE1pc3NpbmciLCJtaXNzaW5nIiwiaGFuZGxlZCIsIkJMT0NLUyIsIklubGluZXMiLCJJTkxJTkVTIiwicG9wdWxhdGVCdWlsdGlucyIsIl9oYXNoIiwiaW52b2tlU3RhdGljIiwianVtcCIsImp1bXBJZiIsInB1dEl0ZXJhdG9yIiwiZnAiLCJlbnRlckxpc3QiLCJpdGVyYXRlIiwiZXhpdExpc3QiLCJrZXlzIiwidmFsdWVzIiwicHVzaFJlbW90ZUVsZW1lbnQiLCJwb3BSZW1vdGVFbGVtZW50IiwiX3BhcmFtcyIsImV4cHJlc3Npb25zIiwicHVzaER5bmFtaWNTY29wZSIsImJpbmREeW5hbWljU2NvcGUiLCJwb3BEeW5hbWljU2NvcGUiLCJjb21waWxlU3RhdGVtZW50Iiwic3RhdGVtZW50IiwiY29tcGlsZVN0YXRlbWVudHMiLCJiIl0sIm1hcHBpbmdzIjoiOzs7Ozs7UUFxVE8sQUFBUztRQXNFVCxBQUFTO1FBZ0ZULEFBQVM7UUFzT1QsQUFBUztRQUdULEFBQVM7O0FBcHJCaEIsQUFBUyxBQUFXOztBQUNwQixBQUFTLEFBQVEsQUFBTSxBQUEyQjs7QUFDbEQsQUFBTzs7SUFBUCxBQUFZLEFBQWdCOztBQUM1QixBQUFPLEFBQW1COzs7O0FBQzFCLEFBQVMsQUFBZ0I7O0FBQ3pCLEFBQU87O0lBQVAsQUFBWSxBQUFnQjs7QUFDNUIsQUFBTyxBQUFvQjs7Ozs7Ozs7Ozs7Ozs7QUFDM0IsSUFBSSxNQUFNLFdBQVYsQUFBcUIsQUFDckI7QUFBTyxJQUFNLG9DQUFOLEFBQW9COztJLEFBQ3JCLHdCQUNGO3lCQUF3QjtZQUFaLEFBQVksNkVBQUgsQUFBRzs7OEJBQ3BCOzthQUFBLEFBQUssU0FBTCxBQUFjLEFBQ2Q7YUFBQSxBQUFLLFFBQUwsQUFBYSxBQUNiO2FBQUEsQUFBSyxRQUFMLEFBQWEsQUFDaEI7Ozt3QixBQUNELG1CLEFBQUksTSxBQUFNLE1BQU0sQUFDWjthQUFBLEFBQUssTUFBTCxBQUFXLEtBQVgsQUFBZ0IsQUFDaEI7YUFBQSxBQUFL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QXVDLEtBQUssQUFDeEM7eUJBQWlCLFdBQWpCLEFBQWlCLEFBQVcsSUFBNUIsQUFBZ0MsQUFDbkM7QUFDRDtXQUFBLEFBQU8sQUFDViIsImZpbGUiOiJsaWIvc3ludGF4L2Z1bmN0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1hcCB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBhc3NlcnQsIGRpY3QsIEVNUFRZX0FSUkFZLCB1bndyYXAgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCAqIGFzIFdpcmVGb3JtYXQgZnJvbSAnQGdsaW1tZXIvd2lyZS1mb3JtYXQnO1xuaW1wb3J0IE9wY29kZUJ1aWxkZXIgZnJvbSAnLi4vY29tcGlsZWQvb3Bjb2Rlcy9idWlsZGVyJztcbmltcG9ydCB7IFJlZ2lzdGVyIH0gZnJvbSAnLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgKiBhcyBDbGllbnRTaWRlIGZyb20gJy4uL3N5bnRheC9jbGllbnQtc2lkZSc7XG5pbXBvcnQgUmF3SW5saW5lQmxvY2sgZnJvbSAnLi9yYXctYmxvY2snO1xudmFyIE9wcyA9IFdpcmVGb3JtYXQuT3BzO1xuZXhwb3J0IGNvbnN0IEFUVFJTX0JMT0NLID0gJyZhdHRycyc7XG5jbGFzcyBDb21waWxlcnMge1xuICAgIGNvbnN0cnVjdG9yKG9mZnNldCA9IDApIHtcbiAgICAgICAgdGhpcy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgIHRoaXMubmFtZXMgPSBkaWN0KCk7XG4gICAgICAgIHRoaXMuZnVuY3MgPSBbXTtcbiAgICB9XG4gICAgYWRkKG5hbWUsIGZ1bmMpIHtcbiAgICAgICAgdGhpcy5mdW5jcy5wdXNoKGZ1bmMpO1xuICAgICAgICB0aGlzLm5hbWVzW25hbWVdID0gdGhpcy5mdW5jcy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBjb21waWxlKHNleHAsIGJ1aWxkZXIpIHtcbiAgICAgICAgbGV0IG5hbWUgPSBzZXhwW3RoaXMub2Zmc2V0XTtcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5uYW1lc1tuYW1lXTtcbiAgICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcbiAgICAgICAgYXNzZXJ0KCEhZnVuYywgYGV4cGVjdGVkIGFuIGltcGxlbWVudGF0aW9uIGZvciAke3RoaXMub2Zmc2V0ID09PSAwID8gT3BzW3NleHBbMF1dIDogQ2xpZW50U2lkZS5PcHNbc2V4cFsxXV19YCk7XG4gICAgICAgIGZ1bmMoc2V4cCwgYnVpbGRlcik7XG4gICAgfVxufVxuY29uc3QgU1RBVEVNRU5UUyA9IG5ldyBDb21waWxlcnMoKTtcbmNvbnN0IENMSUVOVF9TSURFID0gbmV3IENvbXBpbGVycygxKTtcblNUQVRFTUVOVFMuYWRkKE9wcy5UZXh0LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIudGV4dChzZXhwWzFdKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkNvbW1lbnQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5jb21tZW50KHNleHBbMV0pO1xufSk7XG5TVEFURU1FTlRTLmFkZChPcHMuQ2xvc2VFbGVtZW50LCAoX3NleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmNsb3NlRWxlbWVudCgpO1xufSk7XG5TVEFURU1FTlRTLmFkZChPcHMuRmx1c2hFbGVtZW50LCAoX3NleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmZsdXNoRWxlbWVudCgpO1xufSk7XG5TVEFURU1FTlRTLmFkZChPcHMuTW9kaWZpZXIsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IHsgZW52LCBtZXRhIH0gPSBidWlsZGVyO1xuICAgIGxldCBbLCBuYW1lLCBwYXJhbXMsIGhhc2hdID0gc2V4cDtcbiAgICBpZiAoZW52Lmhhc01vZGlmaWVyKG5hbWUsIG1ldGEudGVtcGxhdGVNZXRhKSkge1xuICAgICAgICBidWlsZGVyLmNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgdHJ1ZSk7XG4gICAgICAgIGJ1aWxkZXIubW9kaWZpZXIoZW52Lmxvb2t1cE1vZGlmaWVyKG5hbWUsIG1ldGEudGVtcGxhdGVNZXRhKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yICR7bmFtZX0gaXMgbm90IGEgbW9kaWZpZXI6IEhlbHBlcnMgbWF5IG5vdCBiZSB1c2VkIGluIHRoZSBlbGVtZW50IGZvcm0uYCk7XG4gICAgfVxufSk7XG5TVEFURU1FTlRTLmFkZChPcHMuU3RhdGljQXR0ciwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0gPSBzZXhwO1xuICAgIGJ1aWxkZXIuc3RhdGljQXR0cihuYW1lLCBuYW1lc3BhY2UsIHZhbHVlKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkR5bmFtaWNBdHRyLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGR5bmFtaWNBdHRyKHNleHAsIGZhbHNlLCBidWlsZGVyKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLlRydXN0aW5nQXR0ciwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBkeW5hbWljQXR0cihzZXhwLCB0cnVlLCBidWlsZGVyKTtcbn0pO1xuZnVuY3Rpb24gZHluYW1pY0F0dHIoc2V4cCwgdHJ1c3RpbmcsIGJ1aWxkZXIpIHtcbiAgICBsZXQgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0gPSBzZXhwO1xuICAgIGV4cHIodmFsdWUsIGJ1aWxkZXIpO1xuICAgIGlmIChuYW1lc3BhY2UpIHtcbiAgICAgICAgYnVpbGRlci5keW5hbWljQXR0ck5TKG5hbWUsIG5hbWVzcGFjZSwgdHJ1c3RpbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1aWxkZXIuZHluYW1pY0F0dHIobmFtZSwgdHJ1c3RpbmcpO1xuICAgIH1cbn1cblNUQVRFTUVOVFMuYWRkKE9wcy5PcGVuRWxlbWVudCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLm9wZW5QcmltaXRpdmVFbGVtZW50KHNleHBbMV0pO1xufSk7XG5DTElFTlRfU0lERS5hZGQoQ2xpZW50U2lkZS5PcHMuT3BlbkNvbXBvbmVudEVsZW1lbnQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5wdXNoQ29tcG9uZW50T3BlcmF0aW9ucygpO1xuICAgIGJ1aWxkZXIub3BlbkVsZW1lbnRXaXRoT3BlcmF0aW9ucyhzZXhwWzJdKTtcbn0pO1xuQ0xJRU5UX1NJREUuYWRkKENsaWVudFNpZGUuT3BzLkRpZENyZWF0ZUVsZW1lbnQsIChfc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuZGlkQ3JlYXRlRWxlbWVudChSZWdpc3Rlci5zMCk7XG59KTtcbkNMSUVOVF9TSURFLmFkZChDbGllbnRTaWRlLk9wcy5EaWRSZW5kZXJMYXlvdXQsIChfc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuZGlkUmVuZGVyTGF5b3V0KFJlZ2lzdGVyLnMwKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkFwcGVuZCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgdmFsdWUsIHRydXN0aW5nXSA9IHNleHA7XG4gICAgbGV0IHsgaW5saW5lcyB9ID0gYnVpbGRlci5lbnYubWFjcm9zKCk7XG4gICAgbGV0IHJldHVybmVkID0gaW5saW5lcy5jb21waWxlKHNleHAsIGJ1aWxkZXIpIHx8IHZhbHVlO1xuICAgIGlmIChyZXR1cm5lZCA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgIGxldCBpc0dldCA9IEUuaXNHZXQodmFsdWUpO1xuICAgIGxldCBpc01heWJlTG9jYWwgPSBFLmlzTWF5YmVMb2NhbCh2YWx1ZSk7XG4gICAgaWYgKHRydXN0aW5nKSB7XG4gICAgICAgIGJ1aWxkZXIuZ3VhcmRlZEFwcGVuZCh2YWx1ZSwgdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzR2V0IHx8IGlzTWF5YmVMb2NhbCkge1xuICAgICAgICAgICAgYnVpbGRlci5ndWFyZGVkQXBwZW5kKHZhbHVlLCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHByKHZhbHVlLCBidWlsZGVyKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuY2F1dGlvdXNBcHBlbmQoKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkJsb2NrLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBuYW1lLCBwYXJhbXMsIGhhc2gsIF90ZW1wbGF0ZSwgX2ludmVyc2VdID0gc2V4cDtcbiAgICBsZXQgdGVtcGxhdGUgPSBidWlsZGVyLnRlbXBsYXRlKF90ZW1wbGF0ZSk7XG4gICAgbGV0IGludmVyc2UgPSBidWlsZGVyLnRlbXBsYXRlKF9pbnZlcnNlKTtcbiAgICBsZXQgdGVtcGxhdGVCbG9jayA9IHRlbXBsYXRlICYmIHRlbXBsYXRlLnNjYW4oKTtcbiAgICBsZXQgaW52ZXJzZUJsb2NrID0gaW52ZXJzZSAmJiBpbnZlcnNlLnNjYW4oKTtcbiAgICBsZXQgeyBibG9ja3MgfSA9IGJ1aWxkZXIuZW52Lm1hY3JvcygpO1xuICAgIGJsb2Nrcy5jb21waWxlKG5hbWUsIHBhcmFtcywgaGFzaCwgdGVtcGxhdGVCbG9jaywgaW52ZXJzZUJsb2NrLCBidWlsZGVyKTtcbn0pO1xuZXhwb3J0IGNsYXNzIEludm9rZUR5bmFtaWNMYXlvdXQge1xuICAgIGNvbnN0cnVjdG9yKGF0dHJzKSB7XG4gICAgICAgIHRoaXMuYXR0cnMgPSBhdHRycztcbiAgICB9XG4gICAgaW52b2tlKHZtLCBsYXlvdXQpIHtcbiAgICAgICAgbGV0IHsgc3ltYm9scywgaGFzRXZhbCB9ID0gbGF5b3V0LnN5bWJvbFRhYmxlO1xuICAgICAgICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgICAgICAgbGV0IHNjb3BlID0gdm0ucHVzaFJvb3RTY29wZShzeW1ib2xzLmxlbmd0aCArIDEsIHRydWUpO1xuICAgICAgICBzY29wZS5iaW5kU2VsZihzdGFjay5wb3AoKSk7XG4gICAgICAgIHNjb3BlLmJpbmRCbG9jayhzeW1ib2xzLmluZGV4T2YoQVRUUlNfQkxPQ0spICsgMSwgdGhpcy5hdHRycyk7XG4gICAgICAgIGxldCBsb29rdXAgPSBudWxsO1xuICAgICAgICBsZXQgJGV2YWwgPSAtMTtcbiAgICAgICAgaWYgKGhhc0V2YWwpIHtcbiAgICAgICAgICAgICRldmFsID0gc3ltYm9scy5pbmRleE9mKCckZXZhbCcpICsgMTtcbiAgICAgICAgICAgIGxvb2t1cCA9IGRpY3QoKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2FsbGVyTmFtZXMgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IGNhbGxlck5hbWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBsZXQgc3ltYm9sID0gc3ltYm9scy5pbmRleE9mKGNhbGxlck5hbWVzW2ldKTtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgaWYgKHN5bWJvbCAhPT0gLTEpIHNjb3BlLmJpbmRTeW1ib2woc3ltYm9sICsgMSwgdmFsdWUpO1xuICAgICAgICAgICAgaWYgKGhhc0V2YWwpIGxvb2t1cFtjYWxsZXJOYW1lc1tpXV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbnVtUG9zaXRpb25hbEFyZ3MgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgYXNzZXJ0KHR5cGVvZiBudW1Qb3NpdGlvbmFsQXJncyA9PT0gJ251bWJlcicsICdbQlVHXSBJbmNvcnJlY3QgdmFsdWUgb2YgcG9zaXRpb25hbCBhcmd1bWVudCBjb3VudCBmb3VuZCBkdXJpbmcgaW52b2tlLWR5bmFtaWMtbGF5b3V0LicpO1xuICAgICAgICAvLyBDdXJyZW50bHkgd2UgZG9uJ3Qgc3VwcG9ydCBhY2Nlc3NpbmcgcG9zaXRpb25hbCBhcmdzIGluIHRlbXBsYXRlcywgc28ganVzdCB0aHJvdyB0aGVtIGF3YXlcbiAgICAgICAgc3RhY2sucG9wKG51bVBvc2l0aW9uYWxBcmdzKTtcbiAgICAgICAgbGV0IGludmVyc2VTeW1ib2wgPSBzeW1ib2xzLmluZGV4T2YoJyZpbnZlcnNlJyk7XG4gICAgICAgIGxldCBpbnZlcnNlID0gc3RhY2sucG9wKCk7XG4gICAgICAgIGlmIChpbnZlcnNlU3ltYm9sICE9PSAtMSkge1xuICAgICAgICAgICAgc2NvcGUuYmluZEJsb2NrKGludmVyc2VTeW1ib2wgKyAxLCBpbnZlcnNlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9va3VwKSBsb29rdXBbJyZpbnZlcnNlJ10gPSBpbnZlcnNlO1xuICAgICAgICBsZXQgZGVmYXVsdFN5bWJvbCA9IHN5bWJvbHMuaW5kZXhPZignJmRlZmF1bHQnKTtcbiAgICAgICAgbGV0IGRlZmF1bHRCbG9jayA9IHN0YWNrLnBvcCgpO1xuICAgICAgICBpZiAoZGVmYXVsdFN5bWJvbCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHNjb3BlLmJpbmRCbG9jayhkZWZhdWx0U3ltYm9sICsgMSwgZGVmYXVsdEJsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9va3VwKSBsb29rdXBbJyZkZWZhdWx0J10gPSBkZWZhdWx0QmxvY2s7XG4gICAgICAgIGlmIChsb29rdXApIHNjb3BlLmJpbmRFdmFsU2NvcGUobG9va3VwKTtcbiAgICAgICAgdm0ucHVzaEZyYW1lKCk7XG4gICAgICAgIHZtLmNhbGwobGF5b3V0LmhhbmRsZSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHsgR2xpbW1lckRlYnVnOiAnPGludm9rZS1keW5hbWljLWxheW91dD4nIH07XG4gICAgfVxufVxuU1RBVEVNRU5UUy5hZGQoT3BzLkNvbXBvbmVudCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgdGFnLCBhdHRycywgYXJncywgYmxvY2tdID0gc2V4cDtcbiAgICBpZiAoYnVpbGRlci5lbnYuaGFzQ29tcG9uZW50RGVmaW5pdGlvbih0YWcsIGJ1aWxkZXIubWV0YS50ZW1wbGF0ZU1ldGEpKSB7XG4gICAgICAgIGxldCBjaGlsZCA9IGJ1aWxkZXIudGVtcGxhdGUoYmxvY2spO1xuICAgICAgICBsZXQgYXR0cnNCbG9jayA9IG5ldyBSYXdJbmxpbmVCbG9jayhidWlsZGVyLm1ldGEsIGF0dHJzLCBFTVBUWV9BUlJBWSk7XG4gICAgICAgIGxldCBkZWZpbml0aW9uID0gYnVpbGRlci5lbnYuZ2V0Q29tcG9uZW50RGVmaW5pdGlvbih0YWcsIGJ1aWxkZXIubWV0YS50ZW1wbGF0ZU1ldGEpO1xuICAgICAgICBidWlsZGVyLnB1c2hDb21wb25lbnRNYW5hZ2VyKGRlZmluaXRpb24pO1xuICAgICAgICBidWlsZGVyLmludm9rZUNvbXBvbmVudChhdHRyc0Jsb2NrLCBudWxsLCBhcmdzLCBjaGlsZCAmJiBjaGlsZC5zY2FuKCkpO1xuICAgIH0gZWxzZSBpZiAoYmxvY2sgJiYgYmxvY2sucGFyYW1ldGVycy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yOiBDYW5ub3QgZmluZCBjb21wb25lbnQgJHt0YWd9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnVpbGRlci5vcGVuUHJpbWl0aXZlRWxlbWVudCh0YWcpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBTVEFURU1FTlRTLmNvbXBpbGUoYXR0cnNbaV0sIGJ1aWxkZXIpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuZmx1c2hFbGVtZW50KCk7XG4gICAgICAgIGlmIChibG9jaykge1xuICAgICAgICAgICAgbGV0IHN0bXRzID0gYmxvY2suc3RhdGVtZW50cztcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RtdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBTVEFURU1FTlRTLmNvbXBpbGUoc3RtdHNbaV0sIGJ1aWxkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuY2xvc2VFbGVtZW50KCk7XG4gICAgfVxufSk7XG5leHBvcnQgY2xhc3MgUGFydGlhbEludm9rZXIge1xuICAgIGNvbnN0cnVjdG9yKG91dGVyU3ltYm9scywgZXZhbEluZm8pIHtcbiAgICAgICAgdGhpcy5vdXRlclN5bWJvbHMgPSBvdXRlclN5bWJvbHM7XG4gICAgICAgIHRoaXMuZXZhbEluZm8gPSBldmFsSW5mbztcbiAgICB9XG4gICAgaW52b2tlKHZtLCBfcGFydGlhbCkge1xuICAgICAgICBsZXQgcGFydGlhbCA9IHVud3JhcChfcGFydGlhbCk7XG4gICAgICAgIGxldCBwYXJ0aWFsU3ltYm9scyA9IHBhcnRpYWwuc3ltYm9sVGFibGUuc3ltYm9scztcbiAgICAgICAgbGV0IG91dGVyU2NvcGUgPSB2bS5zY29wZSgpO1xuICAgICAgICBsZXQgcGFydGlhbFNjb3BlID0gdm0ucHVzaFJvb3RTY29wZShwYXJ0aWFsU3ltYm9scy5sZW5ndGgsIGZhbHNlKTtcbiAgICAgICAgcGFydGlhbFNjb3BlLmJpbmRDYWxsZXJTY29wZShvdXRlclNjb3BlLmdldENhbGxlclNjb3BlKCkpO1xuICAgICAgICBwYXJ0aWFsU2NvcGUuYmluZEV2YWxTY29wZShvdXRlclNjb3BlLmdldEV2YWxTY29wZSgpKTtcbiAgICAgICAgcGFydGlhbFNjb3BlLmJpbmRTZWxmKG91dGVyU2NvcGUuZ2V0U2VsZigpKTtcbiAgICAgICAgbGV0IHsgZXZhbEluZm8sIG91dGVyU3ltYm9scyB9ID0gdGhpcztcbiAgICAgICAgbGV0IGxvY2FscyA9IGRpY3QoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmFsSW5mby5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHNsb3QgPSBldmFsSW5mb1tpXTtcbiAgICAgICAgICAgIGxldCBuYW1lID0gb3V0ZXJTeW1ib2xzW3Nsb3QgLSAxXTtcbiAgICAgICAgICAgIGxldCByZWYgPSBvdXRlclNjb3BlLmdldFN5bWJvbChzbG90KTtcbiAgICAgICAgICAgIGxvY2Fsc1tuYW1lXSA9IHJlZjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZXZhbFNjb3BlID0gb3V0ZXJTY29wZS5nZXRFdmFsU2NvcGUoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0aWFsU3ltYm9scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IG5hbWUgPSBwYXJ0aWFsU3ltYm9sc1tpXTtcbiAgICAgICAgICAgIGxldCBzeW1ib2wgPSBpICsgMTtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGV2YWxTY29wZVtuYW1lXTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSBwYXJ0aWFsU2NvcGUuYmluZChzeW1ib2wsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJ0aWFsU2NvcGUuYmluZFBhcnRpYWxNYXAobG9jYWxzKTtcbiAgICAgICAgdm0ucHVzaEZyYW1lKCk7XG4gICAgICAgIHZtLmNhbGwocGFydGlhbC5oYW5kbGUpO1xuICAgIH1cbn1cblNUQVRFTUVOVFMuYWRkKE9wcy5QYXJ0aWFsLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBuYW1lLCBldmFsSW5mb10gPSBzZXhwO1xuICAgIGxldCB7IHRlbXBsYXRlTWV0YSwgc3ltYm9scyB9ID0gYnVpbGRlci5tZXRhO1xuICAgIGZ1bmN0aW9uIGhlbHBlcih2bSwgYXJncykge1xuICAgICAgICBsZXQgeyBlbnYgfSA9IHZtO1xuICAgICAgICBsZXQgbmFtZVJlZiA9IGFyZ3MucG9zaXRpb25hbC5hdCgwKTtcbiAgICAgICAgcmV0dXJuIG1hcChuYW1lUmVmLCBuID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbiA9PT0gJ3N0cmluZycgJiYgbikge1xuICAgICAgICAgICAgICAgIGlmICghZW52Lmhhc1BhcnRpYWwobiwgdGVtcGxhdGVNZXRhKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIGEgcGFydGlhbCBuYW1lZCBcIiR7bn1cImApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZW52Lmxvb2t1cFBhcnRpYWwobiwgdGVtcGxhdGVNZXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgYSBwYXJ0aWFsIG5hbWVkIFwiJHtTdHJpbmcobil9XCJgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBidWlsZGVyLnN0YXJ0TGFiZWxzKCk7XG4gICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcbiAgICBleHByKG5hbWUsIGJ1aWxkZXIpO1xuICAgIGJ1aWxkZXIucHVzaEltbWVkaWF0ZSgxKTtcbiAgICBidWlsZGVyLnB1c2hJbW1lZGlhdGUoRU1QVFlfQVJSQVkpO1xuICAgIGJ1aWxkZXIucHVzaEFyZ3ModHJ1ZSk7XG4gICAgYnVpbGRlci5oZWxwZXIoaGVscGVyKTtcbiAgICBidWlsZGVyLmR1cCgpO1xuICAgIGJ1aWxkZXIudGVzdCgnc2ltcGxlJyk7XG4gICAgYnVpbGRlci5lbnRlcigyKTtcbiAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcbiAgICBidWlsZGVyLmdldFBhcnRpYWxUZW1wbGF0ZSgpO1xuICAgIGJ1aWxkZXIuY29tcGlsZUR5bmFtaWNCbG9jaygpO1xuICAgIGJ1aWxkZXIuaW52b2tlRHluYW1pYyhuZXcgUGFydGlhbEludm9rZXIoc3ltYm9scywgZXZhbEluZm8pKTtcbiAgICBidWlsZGVyLnBvcFNjb3BlKCk7XG4gICAgYnVpbGRlci5wb3BGcmFtZSgpO1xuICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICBidWlsZGVyLmV4aXQoKTtcbiAgICBidWlsZGVyLnJldHVybigpO1xuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICBidWlsZGVyLnN0b3BMYWJlbHMoKTtcbn0pO1xuY2xhc3MgSW52b2tlRHluYW1pY1lpZWxkIHtcbiAgICBjb25zdHJ1Y3RvcihjYWxsZXJDb3VudCkge1xuICAgICAgICB0aGlzLmNhbGxlckNvdW50ID0gY2FsbGVyQ291bnQ7XG4gICAgfVxuICAgIGludm9rZSh2bSwgYmxvY2spIHtcbiAgICAgICAgbGV0IHsgY2FsbGVyQ291bnQgfSA9IHRoaXM7XG4gICAgICAgIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICAgICAgICBpZiAoIWJsb2NrKSB7XG4gICAgICAgICAgICAvLyBUbyBiYWxhbmNlIHRoZSBwb3B7RnJhbWUsU2NvcGV9XG4gICAgICAgICAgICB2bS5wdXNoRnJhbWUoKTtcbiAgICAgICAgICAgIHZtLnB1c2hDYWxsZXJTY29wZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0YWJsZSA9IGJsb2NrLnN5bWJvbFRhYmxlO1xuICAgICAgICBsZXQgbG9jYWxzID0gdGFibGUucGFyYW1ldGVyczsgLy8gYWx3YXlzIHByZXNlbnQgaW4gaW5saW5lIGJsb2Nrc1xuICAgICAgICBsZXQgY2FsbGVlQ291bnQgPSBsb2NhbHMgPyBsb2NhbHMubGVuZ3RoIDogMDtcbiAgICAgICAgbGV0IGNvdW50ID0gTWF0aC5taW4oY2FsbGVyQ291bnQsIGNhbGxlZUNvdW50KTtcbiAgICAgICAgdm0ucHVzaEZyYW1lKCk7XG4gICAgICAgIHZtLnB1c2hDYWxsZXJTY29wZShjYWxsZWVDb3VudCA+IDApO1xuICAgICAgICBsZXQgc2NvcGUgPSB2bS5zY29wZSgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHNjb3BlLmJpbmRTeW1ib2wobG9jYWxzW2ldLCBzdGFjay5mcm9tQmFzZShjYWxsZXJDb3VudCAtIGkpKTtcbiAgICAgICAgfVxuICAgICAgICB2bS5jYWxsKGJsb2NrLmhhbmRsZSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHsgR2xpbW1lckRlYnVnOiBgPGludm9rZS1keW5hbWljLXlpZWxkIGNhbGxlci1jb3VudD0ke3RoaXMuY2FsbGVyQ291bnR9PmAgfTtcbiAgICB9XG59XG5TVEFURU1FTlRTLmFkZChPcHMuWWllbGQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHRvLCBwYXJhbXNdID0gc2V4cDtcbiAgICBsZXQgY291bnQgPSBjb21waWxlTGlzdChwYXJhbXMsIGJ1aWxkZXIpO1xuICAgIGJ1aWxkZXIuZ2V0QmxvY2sodG8pO1xuICAgIGJ1aWxkZXIuY29tcGlsZUR5bmFtaWNCbG9jaygpO1xuICAgIGJ1aWxkZXIuaW52b2tlRHluYW1pYyhuZXcgSW52b2tlRHluYW1pY1lpZWxkKGNvdW50KSk7XG4gICAgYnVpbGRlci5wb3BTY29wZSgpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICBpZiAoY291bnQpIHtcbiAgICAgICAgYnVpbGRlci5wb3AoY291bnQpO1xuICAgIH1cbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkRlYnVnZ2VyLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBldmFsSW5mb10gPSBzZXhwO1xuICAgIGJ1aWxkZXIuZGVidWdnZXIoYnVpbGRlci5tZXRhLnN5bWJvbHMsIGV2YWxJbmZvKTtcbn0pO1xuU1RBVEVNRU5UUy5hZGQoT3BzLkNsaWVudFNpZGVTdGF0ZW1lbnQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgQ0xJRU5UX1NJREUuY29tcGlsZShzZXhwLCBidWlsZGVyKTtcbn0pO1xuY29uc3QgRVhQUkVTU0lPTlMgPSBuZXcgQ29tcGlsZXJzKCk7XG5jb25zdCBDTElFTlRfU0lERV9FWFBSUyA9IG5ldyBDb21waWxlcnMoMSk7XG52YXIgRSA9IFdpcmVGb3JtYXQuRXhwcmVzc2lvbnM7XG5leHBvcnQgZnVuY3Rpb24gZXhwcihleHByZXNzaW9uLCBidWlsZGVyKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZXhwcmVzc2lvbikpIHtcbiAgICAgICAgRVhQUkVTU0lPTlMuY29tcGlsZShleHByZXNzaW9uLCBidWlsZGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBidWlsZGVyLnByaW1pdGl2ZShleHByZXNzaW9uKTtcbiAgICB9XG59XG5FWFBSRVNTSU9OUy5hZGQoT3BzLlVua25vd24sIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IG5hbWUgPSBzZXhwWzFdO1xuICAgIGlmIChidWlsZGVyLmVudi5oYXNIZWxwZXIobmFtZSwgYnVpbGRlci5tZXRhLnRlbXBsYXRlTWV0YSkpIHtcbiAgICAgICAgRVhQUkVTU0lPTlMuY29tcGlsZShbT3BzLkhlbHBlciwgbmFtZSwgRU1QVFlfQVJSQVksIG51bGxdLCBidWlsZGVyKTtcbiAgICB9IGVsc2UgaWYgKGJ1aWxkZXIubWV0YS5hc1BhcnRpYWwpIHtcbiAgICAgICAgYnVpbGRlci5yZXNvbHZlTWF5YmVMb2NhbChuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBidWlsZGVyLmdldFZhcmlhYmxlKDApO1xuICAgICAgICBidWlsZGVyLmdldFByb3BlcnR5KG5hbWUpO1xuICAgIH1cbn0pO1xuRVhQUkVTU0lPTlMuYWRkKE9wcy5Db25jYXQsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IHBhcnRzID0gc2V4cFsxXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGV4cHIocGFydHNbaV0sIGJ1aWxkZXIpO1xuICAgIH1cbiAgICBidWlsZGVyLmNvbmNhdChwYXJ0cy5sZW5ndGgpO1xufSk7XG5DTElFTlRfU0lERV9FWFBSUy5hZGQoQ2xpZW50U2lkZS5PcHMuRnVuY3Rpb25FeHByZXNzaW9uLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuZnVuY3Rpb24oc2V4cFsyXSk7XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuSGVscGVyLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCB7IGVudiwgbWV0YSB9ID0gYnVpbGRlcjtcbiAgICBsZXQgWywgbmFtZSwgcGFyYW1zLCBoYXNoXSA9IHNleHA7XG4gICAgaWYgKGVudi5oYXNIZWxwZXIobmFtZSwgbWV0YS50ZW1wbGF0ZU1ldGEpKSB7XG4gICAgICAgIGJ1aWxkZXIuY29tcGlsZUFyZ3MocGFyYW1zLCBoYXNoLCB0cnVlKTtcbiAgICAgICAgYnVpbGRlci5oZWxwZXIoZW52Lmxvb2t1cEhlbHBlcihuYW1lLCBtZXRhLnRlbXBsYXRlTWV0YSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcGlsZSBFcnJvcjogJHtuYW1lfSBpcyBub3QgYSBoZWxwZXJgKTtcbiAgICB9XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuR2V0LCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBoZWFkLCBwYXRoXSA9IHNleHA7XG4gICAgYnVpbGRlci5nZXRWYXJpYWJsZShoZWFkKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYnVpbGRlci5nZXRQcm9wZXJ0eShwYXRoW2ldKTtcbiAgICB9XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuTWF5YmVMb2NhbCwgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgcGF0aF0gPSBzZXhwO1xuICAgIGlmIChidWlsZGVyLm1ldGEuYXNQYXJ0aWFsKSB7XG4gICAgICAgIGxldCBoZWFkID0gcGF0aFswXTtcbiAgICAgICAgcGF0aCA9IHBhdGguc2xpY2UoMSk7XG4gICAgICAgIGJ1aWxkZXIucmVzb2x2ZU1heWJlTG9jYWwoaGVhZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnVpbGRlci5nZXRWYXJpYWJsZSgwKTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJ1aWxkZXIuZ2V0UHJvcGVydHkocGF0aFtpXSk7XG4gICAgfVxufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLlVuZGVmaW5lZCwgKF9zZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgcmV0dXJuIGJ1aWxkZXIucHJpbWl0aXZlKHVuZGVmaW5lZCk7XG59KTtcbkVYUFJFU1NJT05TLmFkZChPcHMuSGFzQmxvY2ssIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5oYXNCbG9jayhzZXhwWzFdKTtcbn0pO1xuRVhQUkVTU0lPTlMuYWRkKE9wcy5IYXNCbG9ja1BhcmFtcywgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmhhc0Jsb2NrUGFyYW1zKHNleHBbMV0pO1xufSk7XG5FWFBSRVNTSU9OUy5hZGQoT3BzLkNsaWVudFNpZGVFeHByZXNzaW9uLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIENMSUVOVF9TSURFX0VYUFJTLmNvbXBpbGUoc2V4cCwgYnVpbGRlcik7XG59KTtcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlTGlzdChwYXJhbXMsIGJ1aWxkZXIpIHtcbiAgICBpZiAoIXBhcmFtcykgcmV0dXJuIDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZXhwcihwYXJhbXNbaV0sIGJ1aWxkZXIpO1xuICAgIH1cbiAgICByZXR1cm4gcGFyYW1zLmxlbmd0aDtcbn1cbmV4cG9ydCBjbGFzcyBCbG9ja3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm5hbWVzID0gZGljdCgpO1xuICAgICAgICB0aGlzLmZ1bmNzID0gW107XG4gICAgfVxuICAgIGFkZChuYW1lLCBmdW5jKSB7XG4gICAgICAgIHRoaXMuZnVuY3MucHVzaChmdW5jKTtcbiAgICAgICAgdGhpcy5uYW1lc1tuYW1lXSA9IHRoaXMuZnVuY3MubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgYWRkTWlzc2luZyhmdW5jKSB7XG4gICAgICAgIHRoaXMubWlzc2luZyA9IGZ1bmM7XG4gICAgfVxuICAgIGNvbXBpbGUobmFtZSwgcGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikge1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzW25hbWVdO1xuICAgICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYXNzZXJ0KCEhdGhpcy5taXNzaW5nLCBgJHtuYW1lfSBub3QgZm91bmQsIGFuZCBubyBjYXRjaC1hbGwgYmxvY2sgaGFuZGxlciB3YXMgcmVnaXN0ZXJlZGApO1xuICAgICAgICAgICAgbGV0IGZ1bmMgPSB0aGlzLm1pc3Npbmc7XG4gICAgICAgICAgICBsZXQgaGFuZGxlZCA9IGZ1bmMobmFtZSwgcGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcik7XG4gICAgICAgICAgICBhc3NlcnQoISFoYW5kbGVkLCBgJHtuYW1lfSBub3QgZm91bmQsIGFuZCB0aGUgY2F0Y2gtYWxsIGJsb2NrIGhhbmRsZXIgZGlkbid0IGhhbmRsZSBpdGApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcbiAgICAgICAgICAgIGZ1bmMocGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgY29uc3QgQkxPQ0tTID0gbmV3IEJsb2NrcygpO1xuZXhwb3J0IGNsYXNzIElubGluZXMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm5hbWVzID0gZGljdCgpO1xuICAgICAgICB0aGlzLmZ1bmNzID0gW107XG4gICAgfVxuICAgIGFkZChuYW1lLCBmdW5jKSB7XG4gICAgICAgIHRoaXMuZnVuY3MucHVzaChmdW5jKTtcbiAgICAgICAgdGhpcy5uYW1lc1tuYW1lXSA9IHRoaXMuZnVuY3MubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgYWRkTWlzc2luZyhmdW5jKSB7XG4gICAgICAgIHRoaXMubWlzc2luZyA9IGZ1bmM7XG4gICAgfVxuICAgIGNvbXBpbGUoc2V4cCwgYnVpbGRlcikge1xuICAgICAgICBsZXQgdmFsdWUgPSBzZXhwWzFdO1xuICAgICAgICAvLyBUT0RPOiBGaXggdGhpcyBzbyB0aGF0IGV4cHJlc3Npb24gbWFjcm9zIGNhbiByZXR1cm5cbiAgICAgICAgLy8gdGhpbmdzIGxpa2UgY29tcG9uZW50cywgc28gdGhhdCB7e2NvbXBvbmVudCBmb299fVxuICAgICAgICAvLyBpcyB0aGUgc2FtZSBhcyB7eyhjb21wb25lbnQgZm9vKX19XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHJldHVybiBbJ2V4cHInLCB2YWx1ZV07XG4gICAgICAgIGxldCBuYW1lO1xuICAgICAgICBsZXQgcGFyYW1zO1xuICAgICAgICBsZXQgaGFzaDtcbiAgICAgICAgaWYgKHZhbHVlWzBdID09PSBPcHMuSGVscGVyKSB7XG4gICAgICAgICAgICBuYW1lID0gdmFsdWVbMV07XG4gICAgICAgICAgICBwYXJhbXMgPSB2YWx1ZVsyXTtcbiAgICAgICAgICAgIGhhc2ggPSB2YWx1ZVszXTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZVswXSA9PT0gT3BzLlVua25vd24pIHtcbiAgICAgICAgICAgIG5hbWUgPSB2YWx1ZVsxXTtcbiAgICAgICAgICAgIHBhcmFtcyA9IGhhc2ggPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzW25hbWVdO1xuICAgICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCAmJiB0aGlzLm1pc3NpbmcpIHtcbiAgICAgICAgICAgIGxldCBmdW5jID0gdGhpcy5taXNzaW5nO1xuICAgICAgICAgICAgbGV0IHJldHVybmVkID0gZnVuYyhuYW1lLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHJldHVybmVkID09PSBmYWxzZSA/IFsnZXhwcicsIHZhbHVlXSA6IHJldHVybmVkO1xuICAgICAgICB9IGVsc2UgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxldCBmdW5jID0gdGhpcy5mdW5jc1tpbmRleF07XG4gICAgICAgICAgICBsZXQgcmV0dXJuZWQgPSBmdW5jKG5hbWUsIHBhcmFtcywgaGFzaCwgYnVpbGRlcik7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuZWQgPT09IGZhbHNlID8gWydleHByJywgdmFsdWVdIDogcmV0dXJuZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gWydleHByJywgdmFsdWVdO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IElOTElORVMgPSBuZXcgSW5saW5lcygpO1xucG9wdWxhdGVCdWlsdGlucyhCTE9DS1MsIElOTElORVMpO1xuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlQnVpbHRpbnMoYmxvY2tzID0gbmV3IEJsb2NrcygpLCBpbmxpbmVzID0gbmV3IElubGluZXMoKSkge1xuICAgIGJsb2Nrcy5hZGQoJ2lmJywgKHBhcmFtcywgX2hhc2gsIHRlbXBsYXRlLCBpbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgICAgIC8vICAgICAgICBQdXRBcmdzXG4gICAgICAgIC8vICAgICAgICBUZXN0KEVudmlyb25tZW50KVxuICAgICAgICAvLyAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcbiAgICAgICAgLy8gQkVHSU46IE5vb3BcbiAgICAgICAgLy8gICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcbiAgICAgICAgLy8gICAgICAgIEV2YWx1YXRlKGRlZmF1bHQpXG4gICAgICAgIC8vICAgICAgICBKdW1wKEVORClcbiAgICAgICAgLy8gRUxTRTogIE5vb3BcbiAgICAgICAgLy8gICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxuICAgICAgICAvLyBFTkQ6ICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgRXhpdFxuICAgICAgICBpZiAoIXBhcmFtcyB8fCBwYXJhbXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNZTlRBWCBFUlJPUjogI2lmIHJlcXVpcmVzIGEgc2luZ2xlIGFyZ3VtZW50YCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuICAgICAgICBidWlsZGVyLnB1c2hGcmFtZSgpO1xuICAgICAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcbiAgICAgICAgZXhwcihwYXJhbXNbMF0sIGJ1aWxkZXIpO1xuICAgICAgICBidWlsZGVyLnRlc3QoJ2Vudmlyb25tZW50Jyk7XG4gICAgICAgIGJ1aWxkZXIuZW50ZXIoMSk7XG4gICAgICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRUxTRScpO1xuICAgICAgICBidWlsZGVyLmludm9rZVN0YXRpYyh1bndyYXAodGVtcGxhdGUpKTtcbiAgICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuanVtcCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWMoaW52ZXJzZSk7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFWElUJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gICAgfSk7XG4gICAgYmxvY2tzLmFkZCgndW5sZXNzJywgKHBhcmFtcywgX2hhc2gsIHRlbXBsYXRlLCBpbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgICAgIC8vICAgICAgICBQdXRBcmdzXG4gICAgICAgIC8vICAgICAgICBUZXN0KEVudmlyb25tZW50KVxuICAgICAgICAvLyAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcbiAgICAgICAgLy8gQkVHSU46IE5vb3BcbiAgICAgICAgLy8gICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcbiAgICAgICAgLy8gICAgICAgIEV2YWx1YXRlKGRlZmF1bHQpXG4gICAgICAgIC8vICAgICAgICBKdW1wKEVORClcbiAgICAgICAgLy8gRUxTRTogIE5vb3BcbiAgICAgICAgLy8gICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxuICAgICAgICAvLyBFTkQ6ICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgRXhpdFxuICAgICAgICBpZiAoIXBhcmFtcyB8fCBwYXJhbXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNZTlRBWCBFUlJPUjogI3VubGVzcyByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcbiAgICAgICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgICAgIGV4cHIocGFyYW1zWzBdLCBidWlsZGVyKTtcbiAgICAgICAgYnVpbGRlci50ZXN0KCdlbnZpcm9ubWVudCcpO1xuICAgICAgICBidWlsZGVyLmVudGVyKDEpO1xuICAgICAgICBidWlsZGVyLmp1bXBJZignRUxTRScpO1xuICAgICAgICBidWlsZGVyLmludm9rZVN0YXRpYyh1bndyYXAodGVtcGxhdGUpKTtcbiAgICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuanVtcCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWMoaW52ZXJzZSk7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFWElUJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gICAgfSk7XG4gICAgYmxvY2tzLmFkZCgnd2l0aCcsIChwYXJhbXMsIF9oYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgICAgICAvLyAgICAgICAgUHV0QXJnc1xuICAgICAgICAvLyAgICAgICAgVGVzdChFbnZpcm9ubWVudClcbiAgICAgICAgLy8gICAgICAgIEVudGVyKEJFR0lOLCBFTkQpXG4gICAgICAgIC8vIEJFR0lOOiBOb29wXG4gICAgICAgIC8vICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXG4gICAgICAgIC8vICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxuICAgICAgICAvLyAgICAgICAgSnVtcChFTkQpXG4gICAgICAgIC8vIEVMU0U6ICBOb29wXG4gICAgICAgIC8vICAgICAgICBFdmFsdWxhdGUoaW52ZXJzZSlcbiAgICAgICAgLy8gRU5EOiAgIE5vb3BcbiAgICAgICAgLy8gICAgICAgIEV4aXRcbiAgICAgICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICN3aXRoIHJlcXVpcmVzIGEgc2luZ2xlIGFyZ3VtZW50YCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuICAgICAgICBidWlsZGVyLnB1c2hGcmFtZSgpO1xuICAgICAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcbiAgICAgICAgZXhwcihwYXJhbXNbMF0sIGJ1aWxkZXIpO1xuICAgICAgICBidWlsZGVyLmR1cCgpO1xuICAgICAgICBidWlsZGVyLnRlc3QoJ2Vudmlyb25tZW50Jyk7XG4gICAgICAgIGJ1aWxkZXIuZW50ZXIoMik7XG4gICAgICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRUxTRScpO1xuICAgICAgICBidWlsZGVyLmludm9rZVN0YXRpYyh1bndyYXAodGVtcGxhdGUpLCAxKTtcbiAgICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuanVtcCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWMoaW52ZXJzZSk7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFWElUJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gICAgfSk7XG4gICAgYmxvY2tzLmFkZCgnZWFjaCcsIChwYXJhbXMsIGhhc2gsIHRlbXBsYXRlLCBpbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgICAgIC8vICAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcbiAgICAgICAgLy8gQkVHSU46ICBOb29wXG4gICAgICAgIC8vICAgICAgICAgUHV0QXJnc1xuICAgICAgICAvLyAgICAgICAgIFB1dEl0ZXJhYmxlXG4gICAgICAgIC8vICAgICAgICAgSnVtcFVubGVzcyhFTFNFKVxuICAgICAgICAvLyAgICAgICAgIEVudGVyTGlzdChCRUdJTjIsIEVORDIpXG4gICAgICAgIC8vIElURVI6ICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIE5leHRJdGVyKEJSRUFLKVxuICAgICAgICAvLyBCRUdJTjI6IE5vb3BcbiAgICAgICAgLy8gICAgICAgICBQdXNoQ2hpbGRTY29wZVxuICAgICAgICAvLyAgICAgICAgIEV2YWx1YXRlKGRlZmF1bHQpXG4gICAgICAgIC8vICAgICAgICAgUG9wU2NvcGVcbiAgICAgICAgLy8gRU5EMjogICBOb29wXG4gICAgICAgIC8vICAgICAgICAgRXhpdFxuICAgICAgICAvLyAgICAgICAgIEp1bXAoSVRFUilcbiAgICAgICAgLy8gQlJFQUs6ICBOb29wXG4gICAgICAgIC8vICAgICAgICAgRXhpdExpc3RcbiAgICAgICAgLy8gICAgICAgICBKdW1wKEVORClcbiAgICAgICAgLy8gRUxTRTogICBOb29wXG4gICAgICAgIC8vICAgICAgICAgRXZhbHVsYXRlKGludmVyc2UpXG4gICAgICAgIC8vIEVORDogICAgTm9vcFxuICAgICAgICAvLyAgICAgICAgIEV4aXRcbiAgICAgICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuICAgICAgICBidWlsZGVyLnB1c2hGcmFtZSgpO1xuICAgICAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcbiAgICAgICAgaWYgKGhhc2ggJiYgaGFzaFswXVswXSA9PT0gJ2tleScpIHtcbiAgICAgICAgICAgIGV4cHIoaGFzaFsxXVswXSwgYnVpbGRlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVyLnByaW1pdGl2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBleHByKHBhcmFtc1swXSwgYnVpbGRlcik7XG4gICAgICAgIGJ1aWxkZXIuZW50ZXIoMik7XG4gICAgICAgIGJ1aWxkZXIucHV0SXRlcmF0b3IoKTtcbiAgICAgICAgYnVpbGRlci5qdW1wVW5sZXNzKCdFTFNFJyk7XG4gICAgICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG4gICAgICAgIGJ1aWxkZXIucmV0dXJuVG8oJ0lURVInKTtcbiAgICAgICAgYnVpbGRlci5kdXAoUmVnaXN0ZXIuZnAsIDEpO1xuICAgICAgICBidWlsZGVyLmVudGVyTGlzdCgnQk9EWScpO1xuICAgICAgICBidWlsZGVyLmxhYmVsKCdJVEVSJyk7XG4gICAgICAgIGJ1aWxkZXIuaXRlcmF0ZSgnQlJFQUsnKTtcbiAgICAgICAgYnVpbGRlci5sYWJlbCgnQk9EWScpO1xuICAgICAgICBidWlsZGVyLmludm9rZVN0YXRpYyh1bndyYXAodGVtcGxhdGUpLCAyKTtcbiAgICAgICAgYnVpbGRlci5wb3AoMik7XG4gICAgICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICBidWlsZGVyLmxhYmVsKCdCUkVBSycpO1xuICAgICAgICBidWlsZGVyLmV4aXRMaXN0KCk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuanVtcCgnRVhJVCcpO1xuICAgICAgICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWMoaW52ZXJzZSk7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFWElUJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICAgICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgICAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gICAgfSk7XG4gICAgYmxvY2tzLmFkZCgnLWluLWVsZW1lbnQnLCAocGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgX2ludmVyc2UsIGJ1aWxkZXIpID0+IHtcbiAgICAgICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICMtaW4tZWxlbWVudCByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcbiAgICAgICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcbiAgICAgICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG4gICAgICAgIGlmIChoYXNoICYmIGhhc2hbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBsZXQgW2tleXMsIHZhbHVlc10gPSBoYXNoO1xuICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoID09PSAxICYmIGtleXNbMF0gPT09ICduZXh0U2libGluZycpIHtcbiAgICAgICAgICAgICAgICBleHByKHZhbHVlc1swXSwgYnVpbGRlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU1lOVEFYIEVSUk9SOiAjLWluLWVsZW1lbnQgZG9lcyBub3QgdGFrZSBhIFxcYCR7a2V5c1swXX1cXGAgb3B0aW9uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHByKG51bGwsIGJ1aWxkZXIpO1xuICAgICAgICB9XG4gICAgICAgIGV4cHIocGFyYW1zWzBdLCBidWlsZGVyKTtcbiAgICAgICAgYnVpbGRlci5kdXAoKTtcbiAgICAgICAgYnVpbGRlci50ZXN0KCdzaW1wbGUnKTtcbiAgICAgICAgYnVpbGRlci5lbnRlcigzKTtcbiAgICAgICAgYnVpbGRlci5qdW1wVW5sZXNzKCdFTFNFJyk7XG4gICAgICAgIGJ1aWxkZXIucHVzaFJlbW90ZUVsZW1lbnQoKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSk7XG4gICAgICAgIGJ1aWxkZXIucG9wUmVtb3RlRWxlbWVudCgpO1xuICAgICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgICAgICBidWlsZGVyLnJldHVybigpO1xuICAgICAgICBidWlsZGVyLmxhYmVsKCdFTkQnKTtcbiAgICAgICAgYnVpbGRlci5wb3BGcmFtZSgpO1xuICAgICAgICBidWlsZGVyLnN0b3BMYWJlbHMoKTtcbiAgICB9KTtcbiAgICBibG9ja3MuYWRkKCctd2l0aC1keW5hbWljLXZhcnMnLCAoX3BhcmFtcywgaGFzaCwgdGVtcGxhdGUsIF9pbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgICAgIGlmIChoYXNoKSB7XG4gICAgICAgICAgICBsZXQgW25hbWVzLCBleHByZXNzaW9uc10gPSBoYXNoO1xuICAgICAgICAgICAgY29tcGlsZUxpc3QoZXhwcmVzc2lvbnMsIGJ1aWxkZXIpO1xuICAgICAgICAgICAgYnVpbGRlci5wdXNoRHluYW1pY1Njb3BlKCk7XG4gICAgICAgICAgICBidWlsZGVyLmJpbmREeW5hbWljU2NvcGUobmFtZXMpO1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSk7XG4gICAgICAgICAgICBidWlsZGVyLnBvcER5bmFtaWNTY29wZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWModW53cmFwKHRlbXBsYXRlKSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4geyBibG9ja3MsIGlubGluZXMgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlU3RhdGVtZW50KHN0YXRlbWVudCwgYnVpbGRlcikge1xuICAgIFNUQVRFTUVOVFMuY29tcGlsZShzdGF0ZW1lbnQsIGJ1aWxkZXIpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVTdGF0ZW1lbnRzKHN0YXRlbWVudHMsIG1ldGEsIGVudikge1xuICAgIGxldCBiID0gbmV3IE9wY29kZUJ1aWxkZXIoZW52LCBtZXRhKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29tcGlsZVN0YXRlbWVudChzdGF0ZW1lbnRzW2ldLCBiKTtcbiAgICB9XG4gICAgcmV0dXJuIGI7XG59Il19